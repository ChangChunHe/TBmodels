#!/usr/bin/env python
# -*- coding: utf-8 -*-
#
# Author:  Dominik Gresch <greschd@gmx.ch>
# Date:    15.10.2014 10:22:43 CEST
# File:    tb_example.py

from common import *

import os
import types
import shutil

class TbExampleTestCase(BuildDirTestCase):

    def createH(self, t1, t2):

        self.H = z2pack.tb.Hamilton()

        # create the two atoms
        self.H.add_atom(([1, 1], 1), [0, 0, 0])
        self.H.add_atom(([-1, -1], 1), [0.5, 0.5, 0])

        # add hopping between different atoms
        self.H.add_hopping(((0, 0), (1, 1)),
                           z2pack.tb.vectors.combine([0, -1], [0, -1], 0),
                           t1,
                           phase=[1, -1j, 1j, -1])
        self.H.add_hopping(((0, 1), (1, 0)),
                           z2pack.tb.vectors.combine([0, -1], [0, -1], 0),
                           t1,
                           phase=[1, 1j, -1j, -1])

        # add hopping between neighbouring orbitals of the same type
        self.H.add_hopping((((0, 0), (0, 0)), ((0, 1), (0, 1))),
                           z2pack.tb.vectors.neighbours([0, 1],
                                                        forward_only=True),
                           t2,
                           phase=[1])
        self.H.add_hopping((((1, 1), (1, 1)), ((1, 0), (1, 0))),
                           z2pack.tb.vectors.neighbours([0, 1],
                                                        forward_only=True),
                           -t2,
                           phase=[1])

    # this test may produce false negatives due to small numerical differences
    def test_res1(self):
        self.createH(0.2, 0.3)
        # call to Z2Pack
        tb_system = z2pack.tb.System(self.H)
        tb_surface = tb_system.surface(lambda kx, ky: [kx / 2, ky, 0])
        tb_surface.wcc_calc(verbose=False, num_strings=20, pickle_file=None)
        
        res = {'t_par': [0.0, 0.052631578947368418, 0.10526315789473684, 0.15789473684210525, 0.21052631578947367, 0.26315789473684209, 0.31578947368421051, 0.36842105263157893, 0.42105263157894735, 0.47368421052631576, 0.52631578947368418, 0.57894736842105265, 0.63157894736842102, 0.68421052631578938, 0.73684210526315785, 0.78947368421052633, 0.84210526315789469, 0.89473684210526305, 0.94736842105263153, 1.0], 'wcc': [[0.4996901520694727, 0.50030984793052746], [0.49876253242148111, 0.50123746757851895], [0.4976728615885303, 0.50232713841147003], [0.49600000936166949, 0.50399999063833056], [0.49409333798573685, 0.50590666201426315], [0.49135230436336974, 0.50864769563663026], [0.48785649797599739, 0.51214350202400283], [0.48552307044038812, 0.51447692955961188], [0.48189158683153055, 0.51810841316846945], [0.47639375434269693, 0.52360624565730318], [0.47033541279590518, 0.52966458720409493], [0.45747179380673442, 0.54252820619326569], [0.44332613985033992, 0.55667386014966014], [0.41864128648804338, 0.58135871351195667], [0.3803220517880781, 0.61967794821192201], [0.32505166800848173, 0.67494833199151827], [0.24926997659285657, 0.75073002340714345], [0.16110614508591162, 0.83889385491408852], [0.080615635852378603, 0.91938436414762137], [0.00209549872986634, 0.99790450127013386]], 'lambda_': [array([[ -9.99998105e-01-0.00191907j,   1.85644068e-04+0.0002699j ],
       [ -1.85644068e-04+0.0002699j ,  -9.99998105e-01+0.00191907j]]), array([[ -9.99969773e-01 +7.76838982e-03j,
          3.13815396e-04 +8.21519065e-05j],
       [ -3.13815396e-04 +8.21519065e-05j,
         -9.99969773e-01 -7.76838982e-03j]]), array([[ -9.99893103e-01+0.01448243j,   8.85179984e-06+0.00201054j],
       [ -8.85179984e-06+0.00201054j,  -9.99893103e-01-0.01448243j]]), array([[ -9.99684191e-01+0.02508734j,   2.88625050e-05+0.00146394j],
       [ -2.88625050e-05+0.00146394j,  -9.99684191e-01-0.02508734j]]), array([[ -9.99311405e-01+0.03708939j,  -3.17688547e-04-0.00099626j],
       [  3.17688547e-04-0.00099626j,  -9.99311405e-01-0.03708939j]]), array([[-0.99852421+0.05413202j, -0.00387104+0.00203367j],
       [ 0.00387104+0.00203367j, -0.99852421-0.05413202j]]), array([[-0.99709058+0.07614251j, -0.00323052+0.00150485j],
       [ 0.00323052+0.00150485j, -0.99709058-0.07614251j]]), array([[ -9.95865879e-01+0.090594j  ,   5.86100045e-04-0.00659816j],
       [ -5.86100045e-04-0.00659816j,  -9.95865879e-01-0.090594j  ]]), array([[-0.99353420+0.11336773j, -0.00611698-0.00035377j],
       [ 0.00611698-0.00035377j, -0.99353420-0.11336773j]]), array([[-0.98902038+0.14759775j, -0.00708663-0.00183578j],
       [ 0.00708663-0.00183578j, -0.98902038-0.14759775j]]), array([[-0.98267997+0.18396082j, -0.02043786-0.00898849j],
       [ 0.02043786-0.00898849j, -0.98267997-0.18396082j]]), array([[-0.96451064+0.26369883j, -0.01342762+0.00136194j],
       [ 0.01342762+0.00136194j, -0.96451064-0.26369883j]]), array([[-0.93726623+0.34846361j, -0.00347279+0.00964656j],
       [ 0.00347279+0.00964656j, -0.93726623-0.34846361j]]), array([[-0.87216204+0.48722332j, -0.04407323+0.00208698j],
       [ 0.04407323+0.00208698j, -0.87216204-0.48722332j]]), array([[-0.73035232+0.64392037j,  0.22789441+0.0040216j ],
       [-0.22789441+0.0040216j , -0.73035232-0.64392037j]]), array([[-0.45427973+0.89061258j,  0.02086096+0.00199573j],
       [-0.02086096+0.00199573j, -0.45427973-0.89061258j]]), array([[ 0.00458686+0.99115955j,  0.02714388+0.12978794j],
       [-0.02714388+0.12978794j,  0.00458686-0.99115955j]]), array([[ 0.52994573+0.82201656j,  0.19018024-0.08530988j],
       [-0.19018024-0.08530988j,  0.52994573-0.82201656j]]), array([[ 0.87443663+0.48477553j, -0.00533307+0.01802283j],
       [ 0.00533307+0.01802283j,  0.87443663-0.48477553j]]), array([[ 0.99991332+0.0116777j ,  0.00224800-0.00564996j],
       [-0.00224800-0.00564996j,  0.99991332-0.0116777j ]])], 'kpt': [[0.0, 0.0, 0], [0.026315789473684209, 0.0, 0], [0.052631578947368418, 0.0, 0], [0.078947368421052627, 0.0, 0], [0.10526315789473684, 0.0, 0], [0.13157894736842105, 0.0, 0], [0.15789473684210525, 0.0, 0], [0.18421052631578946, 0.0, 0], [0.21052631578947367, 0.0, 0], [0.23684210526315788, 0.0, 0], [0.26315789473684209, 0.0, 0], [0.28947368421052633, 0.0, 0], [0.31578947368421051, 0.0, 0], [0.34210526315789469, 0.0, 0], [0.36842105263157893, 0.0, 0], [0.39473684210526316, 0.0, 0], [0.42105263157894735, 0.0, 0], [0.44736842105263153, 0.0, 0], [0.47368421052631576, 0.0, 0], [0.5, 0.0, 0]], 'gap': [0.0, 0.0, 2.2204460492503131e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.50000000000000011, 0.5, 0.50000000000000011]}

        self.assertFullAlmostEqual(tb_surface.get_res(), res)

    def test_res2(self):
        """ test pos_check=False """
        self.createH(0, 0.3)
        # call to Z2Pack
        tb_system = z2pack.tb.System(self.H)
        tb_surface = tb_system.surface(lambda kx, ky: [kx / 2, ky, 0])
        tb_surface.wcc_calc(verbose=False,
                            num_strings=20,
                            pickle_file=None,
                            pos_tol=None)

        res = {'t_par': [0.0, 0.052631578947368418, 0.10526315789473684, 0.15789473684210525, 0.21052631578947367, 0.26315789473684209, 0.31578947368421051, 0.36842105263157893, 0.42105263157894735, 0.47368421052631576, 0.52631578947368418, 0.57894736842105265, 0.63157894736842102, 0.68421052631578938, 0.73684210526315785, 0.78947368421052633, 0.84210526315789469, 0.89473684210526305, 0.94736842105263153, 1.0], 'wcc': [[0.5, 0.5], [0.5, 0.5], [0.5, 0.5], [0.5, 0.5], [0.5, 0.5], [0.5, 0.5], [0.5, 0.5], [0.5, 0.5], [0.5, 0.5], [0.5, 0.5], [0.5, 0.5], [0.5, 0.5], [0.5, 0.5], [0.5, 0.5], [0.625, 0.625], [0.625, 0.625], [0.625, 0.625], [0.625, 0.625], [0.75, 0.75], [0.75, 0.75]], 'lambda_': [array([[-1. -1.66533454e-16j,  0. +0.00000000e+00j],
       [ 0. +0.00000000e+00j, -1. -1.66533454e-16j]]), array([[-1. -1.66533454e-16j,  0. +0.00000000e+00j],
       [ 0. +0.00000000e+00j, -1. -1.66533454e-16j]]), array([[-1. -1.66533454e-16j,  0. +0.00000000e+00j],
       [ 0. +0.00000000e+00j, -1. -1.66533454e-16j]]), array([[-1. -1.66533454e-16j,  0. +0.00000000e+00j],
       [ 0. +0.00000000e+00j, -1. -1.66533454e-16j]]), array([[-1. -1.66533454e-16j,  0. +0.00000000e+00j],
       [ 0. +0.00000000e+00j, -1. -1.66533454e-16j]]), array([[-1. -1.66533454e-16j,  0. +0.00000000e+00j],
       [ 0. +0.00000000e+00j, -1. -1.66533454e-16j]]), array([[-1. -1.66533454e-16j,  0. +0.00000000e+00j],
       [ 0. +0.00000000e+00j, -1. -1.66533454e-16j]]), array([[-1. -1.66533454e-16j,  0. +0.00000000e+00j],
       [ 0. +0.00000000e+00j, -1. -1.66533454e-16j]]), array([[-1. -1.66533454e-16j,  0. +0.00000000e+00j],
       [ 0. +0.00000000e+00j, -1. -1.66533454e-16j]]), array([[-1. -1.66533454e-16j,  0. +0.00000000e+00j],
       [ 0. +0.00000000e+00j, -1. -1.66533454e-16j]]), array([[-1. -1.66533454e-16j,  0. +0.00000000e+00j],
       [ 0. +0.00000000e+00j, -1. -1.66533454e-16j]]), array([[-1. -1.66533454e-16j,  0. +0.00000000e+00j],
       [ 0. +0.00000000e+00j, -1. -1.66533454e-16j]]), array([[-1. -1.66533454e-16j,  0. +0.00000000e+00j],
       [ 0. +0.00000000e+00j, -1. -1.66533454e-16j]]), array([[-1. -1.66533454e-16j,  0. +0.00000000e+00j],
       [ 0. +0.00000000e+00j, -1. -1.66533454e-16j]]), array([[-0.70710678+0.70710678j,  0.00000000+0.j        ],
       [ 0.00000000+0.j        , -0.70710678+0.70710678j]]), array([[-0.70710678+0.70710678j,  0.00000000+0.j        ],
       [ 0.00000000+0.j        , -0.70710678+0.70710678j]]), array([[-0.70710678+0.70710678j,  0.00000000+0.j        ],
       [ 0.00000000+0.j        , -0.70710678+0.70710678j]]), array([[-0.70710678+0.70710678j,  0.00000000+0.j        ],
       [ 0.00000000+0.j        , -0.70710678+0.70710678j]]), array([[ -1.11022302e-16+1.j,   0.00000000e+00+0.j],
       [  0.00000000e+00+0.j,  -1.11022302e-16+1.j]]), array([[ -1.11022302e-16+1.j,   0.00000000e+00+0.j],
       [  0.00000000e+00+0.j,  -1.11022302e-16+1.j]])], 'kpt': [[0.0, 0.0, 0], [0.026315789473684209, 0.0, 0], [0.052631578947368418, 0.0, 0], [0.078947368421052627, 0.0, 0], [0.10526315789473684, 0.0, 0], [0.13157894736842105, 0.0, 0], [0.15789473684210525, 0.0, 0], [0.18421052631578946, 0.0, 0], [0.21052631578947367, 0.0, 0], [0.23684210526315788, 0.0, 0], [0.26315789473684209, 0.0, 0], [0.28947368421052633, 0.0, 0], [0.31578947368421051, 0.0, 0], [0.34210526315789469, 0.0, 0], [0.36842105263157893, 0.0, 0], [0.39473684210526316, 0.0, 0], [0.42105263157894735, 0.0, 0], [0.44736842105263153, 0.0, 0], [0.47368421052631576, 0.0, 0], [0.5, 0.0, 0]], 'gap': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.125, 0.125, 0.125, 0.125, 0.25, 0.25]}

        self.assertFullAlmostEqual(tb_surface.get_res(), res)

    def test_res3(self):
        """ test gap_tol=None """
        self.createH(0.1, 0.3)
        # call to Z2Pack
        tb_system = z2pack.tb.System(self.H)
        tb_surface = tb_system.surface(lambda kx, ky: [kx / 2, ky, 0])
        tb_surface.wcc_calc(verbose=False,
                            num_strings=20,
                            pickle_file=None,
                            gap_tol=None)

        res = {'t_par': [0.0, 0.052631578947368418, 0.10526315789473684, 0.15789473684210525, 0.21052631578947367, 0.26315789473684209, 0.31578947368421051, 0.36842105263157893, 0.42105263157894735, 0.47368421052631576, 0.52631578947368418, 0.57894736842105265, 0.63157894736842102, 0.68421052631578938, 0.73684210526315785, 0.78947368421052633, 0.84210526315789469, 0.89473684210526305, 0.94736842105263153, 1.0], 'wcc': [[0.49991770091337534, 0.50008229908662472], [0.49968126598293366, 0.50031873401706628], [0.4992104974293225, 0.50078950257067789], [0.49871381470273785, 0.50128618529726232], [0.49804447287205544, 0.50195552712794456], [0.49724082022680699, 0.50275917977319329], [0.49711582350367939, 0.50288417649632078], [0.49574994866506122, 0.50425005133493883], [0.49487871121476157, 0.50512128878523843], [0.49279223903105446, 0.50720776096894538], [0.48950969540882477, 0.51049030459117528], [0.48587599826742339, 0.51412400173257655], [0.47765362516422472, 0.52234637483577551], [0.46048888254755654, 0.53951111745244373], [0.41527235890704178, 0.58472764109295827], [0.32443256353158906, 0.67556743646841111], [0.22812573517974574, 0.77187426482025434], [0.14311538314097094, 0.85688461685902917], [0.06848074969043165, 0.93151925030956839], [0.00080745884482689274, 0.99919254115517309]], 'lambda_': [array([[ -9.99999866e-01 -5.14131664e-04j,
          3.22265436e-05 +4.49765933e-05j],
       [ -3.22265436e-05 +4.49765933e-05j,
         -9.99999866e-01 +5.14131664e-04j]]), array([[ -9.99997995e-01 +2.00149487e-03j,
          6.83890250e-05 -1.58707183e-06j],
       [ -6.83890250e-05 -1.58707183e-06j,
         -9.99997995e-01 -2.00149487e-03j]]), array([[ -9.99987696e-01+0.00495541j,   2.67751188e-05+0.00022464j],
       [ -2.67751188e-05+0.00022464j,  -9.99987696e-01-0.00495541j]]), array([[ -9.99967346e-01+0.00807712j,   6.90869872e-05-0.00024911j],
       [ -6.90869872e-05-0.00024911j,  -9.99967346e-01-0.00807712j]]), array([[ -9.99924517e-01+0.01227853j,   2.56835259e-04+0.00036487j],
       [ -2.56835259e-04+0.00036487j,  -9.99924517e-01-0.01227853j]]), array([[ -9.99849728e-01+0.01732057j,  -6.83100297e-04+0.00023087j],
       [  6.83100297e-04+0.00023087j,  -9.99849728e-01-0.01732057j]]), array([[ -9.99835804e-01+0.01811461j,  -3.50651515e-04+0.00031976j],
       [  3.50651515e-04+0.00031976j,  -9.99835804e-01-0.01811461j]]), array([[ -9.99643473e-01+0.02667417j,  -5.56218704e-04-0.00105158j],
       [  5.56218704e-04-0.00105158j,  -9.99643473e-01-0.02667417j]]), array([[ -9.99482333e-01 +3.21599185e-02j,
         -8.95014169e-04 -7.32802674e-05j],
       [  8.95014169e-04 -7.32802674e-05j,
         -9.99482333e-01 -3.21599185e-02j]]), array([[-0.99897469+0.04525061j, -0.00134747-0.00037476j],
       [ 0.00134747-0.00037476j, -0.99897469-0.04525061j]]), array([[-0.99782856+0.06584245j, -0.00136041-0.00104605j],
       [ 0.00136041-0.00104605j, -0.99782856-0.06584245j]]), array([[-0.99606486 +8.86172810e-02j, -0.00132924 -7.72978244e-05j],
       [ 0.00132924 -7.72978244e-05j, -0.99606486 -8.86172810e-02j]]), array([[-0.99015920+0.13992055j, -0.00193183+0.001806j  ],
       [ 0.00193183+0.001806j  , -0.99015920-0.13992055j]]), array([[-0.96934250+0.24543567j, -0.01089432-0.00421451j],
       [ 0.01089432-0.00421451j, -0.96934250-0.24543567j]]), array([[-0.86161188+0.49618605j,  0.10670361+0.00622186j],
       [-0.10670361+0.00622186j, -0.86161188-0.49618605j]]), array([[-0.45081091+0.89261237j,  0.00324402+0.00146624j],
       [-0.00324402+0.00146624j, -0.45081091-0.89261237j]]), array([[ 0.13700777+0.98699585j, -0.03894407-0.0745079j ],
       [ 0.03894407-0.0745079j ,  0.13700777-0.98699585j]]), array([[ 0.62222040+0.78191942j, -0.02902613+0.024521j  ],
       [ 0.02902613+0.024521j  ,  0.62222040-0.78191942j]]), array([[  9.08850141e-01+0.41712231j,   2.45178668e-05+0.00062861j],
       [ -2.45178668e-05+0.00062861j,   9.08850141e-01-0.41712231j]]), array([[  9.99987130e-01+0.00342628j,   5.60131360e-04-0.00369949j],
       [ -5.60131360e-04-0.00369949j,   9.99987130e-01-0.00342628j]])], 'kpt': [[0.0, 0.0, 0], [0.026315789473684209, 0.0, 0], [0.052631578947368418, 0.0, 0], [0.078947368421052627, 0.0, 0], [0.10526315789473684, 0.0, 0], [0.13157894736842105, 0.0, 0], [0.15789473684210525, 0.0, 0], [0.18421052631578946, 0.0, 0], [0.21052631578947367, 0.0, 0], [0.23684210526315788, 0.0, 0], [0.26315789473684209, 0.0, 0], [0.28947368421052633, 0.0, 0], [0.31578947368421051, 0.0, 0], [0.34210526315789469, 0.0, 0], [0.36842105263157893, 0.0, 0], [0.39473684210526316, 0.0, 0], [0.42105263157894735, 0.0, 0], [0.44736842105263153, 0.0, 0], [0.47368421052631576, 0.0, 0], [0.5, 0.0, 0]], 'gap': [0.0, 0.0, 2.2204460492503131e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.5, 0.5, 0.5]}

        self.assertFullAlmostEqual(tb_surface.get_res(), res)

    def test_res4(self):
        """ test move_tol=None """
        self.createH(0.1, 0.3)
        # call to Z2Pack
        tb_system = z2pack.tb.System(self.H)
        tb_surface = tb_system.surface(lambda kx, ky: [kx / 2, ky, 0])
        tb_surface.wcc_calc(verbose=False,
                          num_strings=20,
                          pickle_file=None,
                          move_tol=None)

        res = {'t_par': [0.0, 0.052631578947368418, 0.10526315789473684, 0.15789473684210525, 0.21052631578947367, 0.26315789473684209, 0.31578947368421051, 0.36842105263157893, 0.42105263157894735, 0.47368421052631576, 0.52631578947368418, 0.57894736842105265, 0.63157894736842102, 0.68421052631578938, 0.73684210526315785, 0.78947368421052633, 0.84210526315789469, 0.89473684210526305, 0.94736842105263153, 1.0], 'wcc': [[0.49991770091337534, 0.50008229908662472], [0.49968126598293366, 0.50031873401706628], [0.4992104974293225, 0.50078950257067789], [0.49871381470273785, 0.50128618529726232], [0.49804447287205544, 0.50195552712794456], [0.49724082022680699, 0.50275917977319329], [0.49711582350367939, 0.50288417649632078], [0.49574994866506122, 0.50425005133493883], [0.49487871121476157, 0.50512128878523843], [0.49279223903105446, 0.50720776096894538], [0.48950969540882477, 0.51049030459117528], [0.48587599826742339, 0.51412400173257655], [0.47765362516422472, 0.52234637483577551], [0.46048888254755654, 0.53951111745244373], [0.41527235890704178, 0.58472764109295827], [0.32443256353158906, 0.67556743646841111], [0.22812573517974574, 0.77187426482025434], [0.14311538314097094, 0.85688461685902917], [0.06848074969043165, 0.93151925030956839], [0.00080745884482689274, 0.99919254115517309]], 'lambda_': [array([[ -9.99999866e-01 -5.14131664e-04j,
          3.22265436e-05 +4.49765933e-05j],
       [ -3.22265436e-05 +4.49765933e-05j,
         -9.99999866e-01 +5.14131664e-04j]]), array([[ -9.99997995e-01 +2.00149487e-03j,
          6.83890250e-05 -1.58707183e-06j],
       [ -6.83890250e-05 -1.58707183e-06j,
         -9.99997995e-01 -2.00149487e-03j]]), array([[ -9.99987696e-01+0.00495541j,   2.67751188e-05+0.00022464j],
       [ -2.67751188e-05+0.00022464j,  -9.99987696e-01-0.00495541j]]), array([[ -9.99967346e-01+0.00807712j,   6.90869872e-05-0.00024911j],
       [ -6.90869872e-05-0.00024911j,  -9.99967346e-01-0.00807712j]]), array([[ -9.99924517e-01+0.01227853j,   2.56835259e-04+0.00036487j],
       [ -2.56835259e-04+0.00036487j,  -9.99924517e-01-0.01227853j]]), array([[ -9.99849728e-01+0.01732057j,  -6.83100297e-04+0.00023087j],
       [  6.83100297e-04+0.00023087j,  -9.99849728e-01-0.01732057j]]), array([[ -9.99835804e-01+0.01811461j,  -3.50651515e-04+0.00031976j],
       [  3.50651515e-04+0.00031976j,  -9.99835804e-01-0.01811461j]]), array([[ -9.99643473e-01+0.02667417j,  -5.56218704e-04-0.00105158j],
       [  5.56218704e-04-0.00105158j,  -9.99643473e-01-0.02667417j]]), array([[ -9.99482333e-01 +3.21599185e-02j,
         -8.95014169e-04 -7.32802674e-05j],
       [  8.95014169e-04 -7.32802674e-05j,
         -9.99482333e-01 -3.21599185e-02j]]), array([[-0.99897469+0.04525061j, -0.00134747-0.00037476j],
       [ 0.00134747-0.00037476j, -0.99897469-0.04525061j]]), array([[-0.99782856+0.06584245j, -0.00136041-0.00104605j],
       [ 0.00136041-0.00104605j, -0.99782856-0.06584245j]]), array([[-0.99606486 +8.86172810e-02j, -0.00132924 -7.72978244e-05j],
       [ 0.00132924 -7.72978244e-05j, -0.99606486 -8.86172810e-02j]]), array([[-0.99015920+0.13992055j, -0.00193183+0.001806j  ],
       [ 0.00193183+0.001806j  , -0.99015920-0.13992055j]]), array([[-0.96934250+0.24543567j, -0.01089432-0.00421451j],
       [ 0.01089432-0.00421451j, -0.96934250-0.24543567j]]), array([[-0.86161188+0.49618605j,  0.10670361+0.00622186j],
       [-0.10670361+0.00622186j, -0.86161188-0.49618605j]]), array([[-0.45081091+0.89261237j,  0.00324402+0.00146624j],
       [-0.00324402+0.00146624j, -0.45081091-0.89261237j]]), array([[ 0.13700777+0.98699585j, -0.03894407-0.0745079j ],
       [ 0.03894407-0.0745079j ,  0.13700777-0.98699585j]]), array([[ 0.62222040+0.78191942j, -0.02902613+0.024521j  ],
       [ 0.02902613+0.024521j  ,  0.62222040-0.78191942j]]), array([[  9.08850141e-01+0.41712231j,   2.45178668e-05+0.00062861j],
       [ -2.45178668e-05+0.00062861j,   9.08850141e-01-0.41712231j]]), array([[  9.99987130e-01+0.00342628j,   5.60131360e-04-0.00369949j],
       [ -5.60131360e-04-0.00369949j,   9.99987130e-01-0.00342628j]])], 'kpt': [[0.0, 0.0, 0], [0.026315789473684209, 0.0, 0], [0.052631578947368418, 0.0, 0], [0.078947368421052627, 0.0, 0], [0.10526315789473684, 0.0, 0], [0.13157894736842105, 0.0, 0], [0.15789473684210525, 0.0, 0], [0.18421052631578946, 0.0, 0], [0.21052631578947367, 0.0, 0], [0.23684210526315788, 0.0, 0], [0.26315789473684209, 0.0, 0], [0.28947368421052633, 0.0, 0], [0.31578947368421051, 0.0, 0], [0.34210526315789469, 0.0, 0], [0.36842105263157893, 0.0, 0], [0.39473684210526316, 0.0, 0], [0.42105263157894735, 0.0, 0], [0.44736842105263153, 0.0, 0], [0.47368421052631576, 0.0, 0], [0.5, 0.0, 0]], 'gap': [0.0, 0.0, 2.2204460492503131e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.5, 0.5, 0.5]}

        self.assertFullAlmostEqual(tb_surface.get_res(), res)

    def test_res5(self):
        """ test gap_tol=None and move_tol=None"""
        self.createH(0.1, 0.3)
        # call to Z2Pack
        tb_system = z2pack.tb.System(self.H)
        tb_surface = tb_system.surface(lambda kx, ky: [kx / 2, ky, 0])
        tb_surface.wcc_calc(verbose=False,
                            num_strings=20,
                            pickle_file=None,
                            gap_tol=None,
                            move_tol=None)

        res = {'t_par': [0.0, 0.052631578947368418, 0.10526315789473684, 0.15789473684210525, 0.21052631578947367, 0.26315789473684209, 0.31578947368421051, 0.36842105263157893, 0.42105263157894735, 0.47368421052631576, 0.52631578947368418, 0.57894736842105265, 0.63157894736842102, 0.68421052631578938, 0.73684210526315785, 0.78947368421052633, 0.84210526315789469, 0.89473684210526305, 0.94736842105263153, 1.0], 'wcc': [[0.49991770091337534, 0.50008229908662472], [0.49968126598293366, 0.50031873401706628], [0.4992104974293225, 0.50078950257067789], [0.49871381470273785, 0.50128618529726232], [0.49804447287205544, 0.50195552712794456], [0.49724082022680699, 0.50275917977319329], [0.49711582350367939, 0.50288417649632078], [0.49574994866506122, 0.50425005133493883], [0.49487871121476157, 0.50512128878523843], [0.49279223903105446, 0.50720776096894538], [0.48950969540882477, 0.51049030459117528], [0.48587599826742339, 0.51412400173257655], [0.47765362516422472, 0.52234637483577551], [0.46048888254755654, 0.53951111745244373], [0.41527235890704178, 0.58472764109295827], [0.32443256353158906, 0.67556743646841111], [0.22812573517974574, 0.77187426482025434], [0.14311538314097094, 0.85688461685902917], [0.06848074969043165, 0.93151925030956839], [0.00080745884482689274, 0.99919254115517309]], 'lambda_': [array([[ -9.99999866e-01 -5.14131664e-04j,
          3.22265436e-05 +4.49765933e-05j],
       [ -3.22265436e-05 +4.49765933e-05j,
         -9.99999866e-01 +5.14131664e-04j]]), array([[ -9.99997995e-01 +2.00149487e-03j,
          6.83890250e-05 -1.58707183e-06j],
       [ -6.83890250e-05 -1.58707183e-06j,
         -9.99997995e-01 -2.00149487e-03j]]), array([[ -9.99987696e-01+0.00495541j,   2.67751188e-05+0.00022464j],
       [ -2.67751188e-05+0.00022464j,  -9.99987696e-01-0.00495541j]]), array([[ -9.99967346e-01+0.00807712j,   6.90869872e-05-0.00024911j],
       [ -6.90869872e-05-0.00024911j,  -9.99967346e-01-0.00807712j]]), array([[ -9.99924517e-01+0.01227853j,   2.56835259e-04+0.00036487j],
       [ -2.56835259e-04+0.00036487j,  -9.99924517e-01-0.01227853j]]), array([[ -9.99849728e-01+0.01732057j,  -6.83100297e-04+0.00023087j],
       [  6.83100297e-04+0.00023087j,  -9.99849728e-01-0.01732057j]]), array([[ -9.99835804e-01+0.01811461j,  -3.50651515e-04+0.00031976j],
       [  3.50651515e-04+0.00031976j,  -9.99835804e-01-0.01811461j]]), array([[ -9.99643473e-01+0.02667417j,  -5.56218704e-04-0.00105158j],
       [  5.56218704e-04-0.00105158j,  -9.99643473e-01-0.02667417j]]), array([[ -9.99482333e-01 +3.21599185e-02j,
         -8.95014169e-04 -7.32802674e-05j],
       [  8.95014169e-04 -7.32802674e-05j,
         -9.99482333e-01 -3.21599185e-02j]]), array([[-0.99897469+0.04525061j, -0.00134747-0.00037476j],
       [ 0.00134747-0.00037476j, -0.99897469-0.04525061j]]), array([[-0.99782856+0.06584245j, -0.00136041-0.00104605j],
       [ 0.00136041-0.00104605j, -0.99782856-0.06584245j]]), array([[-0.99606486 +8.86172810e-02j, -0.00132924 -7.72978244e-05j],
       [ 0.00132924 -7.72978244e-05j, -0.99606486 -8.86172810e-02j]]), array([[-0.99015920+0.13992055j, -0.00193183+0.001806j  ],
       [ 0.00193183+0.001806j  , -0.99015920-0.13992055j]]), array([[-0.96934250+0.24543567j, -0.01089432-0.00421451j],
       [ 0.01089432-0.00421451j, -0.96934250-0.24543567j]]), array([[-0.86161188+0.49618605j,  0.10670361+0.00622186j],
       [-0.10670361+0.00622186j, -0.86161188-0.49618605j]]), array([[-0.45081091+0.89261237j,  0.00324402+0.00146624j],
       [-0.00324402+0.00146624j, -0.45081091-0.89261237j]]), array([[ 0.13700777+0.98699585j, -0.03894407-0.0745079j ],
       [ 0.03894407-0.0745079j ,  0.13700777-0.98699585j]]), array([[ 0.62222040+0.78191942j, -0.02902613+0.024521j  ],
       [ 0.02902613+0.024521j  ,  0.62222040-0.78191942j]]), array([[  9.08850141e-01+0.41712231j,   2.45178668e-05+0.00062861j],
       [ -2.45178668e-05+0.00062861j,   9.08850141e-01-0.41712231j]]), array([[  9.99987130e-01+0.00342628j,   5.60131360e-04-0.00369949j],
       [ -5.60131360e-04-0.00369949j,   9.99987130e-01-0.00342628j]])], 'kpt': [[0.0, 0.0, 0], [0.026315789473684209, 0.0, 0], [0.052631578947368418, 0.0, 0], [0.078947368421052627, 0.0, 0], [0.10526315789473684, 0.0, 0], [0.13157894736842105, 0.0, 0], [0.15789473684210525, 0.0, 0], [0.18421052631578946, 0.0, 0], [0.21052631578947367, 0.0, 0], [0.23684210526315788, 0.0, 0], [0.26315789473684209, 0.0, 0], [0.28947368421052633, 0.0, 0], [0.31578947368421051, 0.0, 0], [0.34210526315789469, 0.0, 0], [0.36842105263157893, 0.0, 0], [0.39473684210526316, 0.0, 0], [0.42105263157894735, 0.0, 0], [0.44736842105263153, 0.0, 0], [0.47368421052631576, 0.0, 0], [0.5, 0.0, 0]], 'gap': [0.0, 0.0, 2.2204460492503131e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.5, 0.5, 0.5]}

        self.assertFullAlmostEqual(tb_surface.get_res(), res)

    def test_res6(self):
        """ Force convergence errors"""
        self.createH(0.1, 0.3)
        # call to Z2Pack
        tb_system = z2pack.tb.System(self.H)
        tb_surface = tb_system.surface(lambda kx, ky: [kx / 2, ky, 0])
        tb_surface.wcc_calc(verbose=False,
                            num_strings=20,
                            pickle_file=None,
                            pos_tol=1e-12,
                            iterator=range(6, 10, 2),
                            gap_tol=1.,
                            move_tol=1e-12,
                            min_neighbour_dist=5e-3)

        res = {'t_par': [0.0, 0.0032894736842105261, 0.0065789473684210523, 0.0098684210526315784, 0.013157894736842105, 0.016447368421052631, 0.019736842105263157, 0.023026315789473683, 0.026315789473684209, 0.029605263157894735, 0.032894736842105261, 0.036184210526315791, 0.039473684210526314, 0.042763157894736836, 0.046052631578947366, 0.049342105263157895, 0.052631578947368418, 0.055921052631578941, 0.05921052631578947, 0.0625, 0.065789473684210523, 0.069078947368421045, 0.072368421052631582, 0.075657894736842105, 0.078947368421052627, 0.08223684210526315, 0.085526315789473673, 0.088815789473684209, 0.092105263157894732, 0.095394736842105254, 0.098684210526315791, 0.10197368421052631, 0.10526315789473684, 0.10855263157894736, 0.11184210526315788, 0.11513157894736842, 0.11842105263157894, 0.12171052631578946, 0.125, 0.12828947368421051, 0.13157894736842105, 0.13486842105263158, 0.13815789473684209, 0.14144736842105263, 0.14473684210526316, 0.14802631578947367, 0.15131578947368421, 0.15460526315789475, 0.15789473684210525, 0.16118421052631576, 0.1644736842105263, 0.16776315789473684, 0.17105263157894735, 0.17434210526315788, 0.17763157894736842, 0.18092105263157893, 0.18421052631578946, 0.1875, 0.19078947368421051, 0.19407894736842105, 0.19736842105263158, 0.20065789473684209, 0.20394736842105263, 0.20723684210526316, 0.21052631578947367, 0.21381578947368418, 0.21710526315789472, 0.22039473684210525, 0.22368421052631576, 0.2269736842105263, 0.23026315789473684, 0.23355263157894735, 0.23684210526315788, 0.24013157894736842, 0.24342105263157893, 0.24671052631578946, 0.25, 0.25328947368421051, 0.25657894736842102, 0.25986842105263153, 0.26315789473684209, 0.26644736842105265, 0.26973684210526316, 0.27302631578947367, 0.27631578947368418, 0.27960526315789469, 0.28289473684210525, 0.28618421052631582, 0.28947368421052633, 0.29276315789473684, 0.29605263157894735, 0.29934210526315785, 0.30263157894736842, 0.30592105263157898, 0.30921052631578949, 0.3125, 0.31578947368421051, 0.31907894736842102, 0.32236842105263153, 0.32565789473684204, 0.3289473684210526, 0.33223684210526316, 0.33552631578947367, 0.33881578947368418, 0.34210526315789469, 0.3453947368421052, 0.34868421052631576, 0.35197368421052633, 0.35526315789473684, 0.35855263157894735, 0.36184210526315785, 0.36513157894736836, 0.36842105263157893, 0.37171052631578949, 0.375, 0.37828947368421051, 0.38157894736842102, 0.38486842105263153, 0.38815789473684209, 0.39144736842105265, 0.39473684210526316, 0.39802631578947367, 0.40131578947368418, 0.40460526315789469, 0.40789473684210525, 0.41118421052631582, 0.41447368421052633, 0.41776315789473684, 0.42105263157894735, 0.42434210526315785, 0.42763157894736836, 0.43092105263157887, 0.43421052631578944, 0.4375, 0.44078947368421051, 0.44407894736842102, 0.44736842105263153, 0.45065789473684204, 0.4539473684210526, 0.45723684210526316, 0.46052631578947367, 0.46381578947368418, 0.46710526315789469, 0.4703947368421052, 0.47368421052631576, 0.47697368421052633, 0.48026315789473684, 0.48355263157894735, 0.48684210526315785, 0.49013157894736836, 0.49342105263157893, 0.49671052631578949, 0.5, 0.50328947368421051, 0.50657894736842102, 0.50986842105263153, 0.51315789473684204, 0.51644736842105254, 0.51973684210526305, 0.52302631578947367, 0.52631578947368418, 0.52960526315789469, 0.53289473684210531, 0.53618421052631582, 0.53947368421052633, 0.54276315789473684, 0.54605263157894735, 0.54934210526315785, 0.55263157894736836, 0.55592105263157887, 0.55921052631578938, 0.5625, 0.56578947368421051, 0.56907894736842102, 0.57236842105263164, 0.57565789473684215, 0.57894736842105265, 0.58223684210526316, 0.58552631578947367, 0.58881578947368418, 0.59210526315789469, 0.5953947368421052, 0.59868421052631571, 0.60197368421052633, 0.60526315789473684, 0.60855263157894735, 0.61184210526315796, 0.61513157894736847, 0.61842105263157898, 0.62171052631578949, 0.625, 0.62828947368421051, 0.63157894736842102, 0.63486842105263153, 0.63815789473684204, 0.64144736842105254, 0.64473684210526305, 0.64802631578947356, 0.65131578947368407, 0.65460526315789469, 0.6578947368421052, 0.66118421052631571, 0.66447368421052633, 0.66776315789473684, 0.67105263157894735, 0.67434210526315785, 0.67763157894736836, 0.68092105263157887, 0.68421052631578938, 0.68749999999999989, 0.6907894736842104, 0.69407894736842102, 0.69736842105263153, 0.70065789473684204, 0.70394736842105265, 0.70723684210526316, 0.71052631578947367, 0.71381578947368418, 0.71710526315789469, 0.7203947368421052, 0.72368421052631571, 0.72697368421052622, 0.73026315789473673, 0.73355263157894735, 0.73684210526315785, 0.74013157894736836, 0.74342105263157898, 0.74671052631578949, 0.75, 0.75328947368421051, 0.75657894736842102, 0.75986842105263153, 0.76315789473684204, 0.76644736842105254, 0.76973684210526305, 0.77302631578947367, 0.77631578947368418, 0.77960526315789469, 0.78289473684210531, 0.78618421052631582, 0.78947368421052633, 0.79276315789473684, 0.79605263157894735, 0.79934210526315785, 0.80263157894736836, 0.80592105263157887, 0.80921052631578938, 0.8125, 0.81578947368421051, 0.81907894736842102, 0.82236842105263164, 0.82565789473684215, 0.82894736842105265, 0.83223684210526316, 0.83552631578947367, 0.83881578947368418, 0.84210526315789469, 0.8453947368421052, 0.84868421052631571, 0.85197368421052622, 0.85526315789473673, 0.85855263157894723, 0.86184210526315774, 0.86513157894736836, 0.86842105263157887, 0.87171052631578938, 0.875, 0.87828947368421051, 0.88157894736842102, 0.88486842105263153, 0.88815789473684204, 0.89144736842105254, 0.89473684210526305, 0.89802631578947356, 0.90131578947368407, 0.90460526315789469, 0.9078947368421052, 0.91118421052631571, 0.91447368421052633, 0.91776315789473684, 0.92105263157894735, 0.92434210526315785, 0.92763157894736836, 0.93092105263157887, 0.93421052631578938, 0.93749999999999989, 0.9407894736842104, 0.94407894736842102, 0.94736842105263153, 0.95065789473684204, 0.95394736842105265, 0.95723684210526316, 0.96052631578947367, 0.96381578947368418, 0.96710526315789469, 0.9703947368421052, 0.97368421052631571, 0.97697368421052622, 0.98026315789473673, 0.98355263157894735, 0.98684210526315785, 0.99013157894736836, 0.99342105263157898, 0.99671052631578949, 1.0], 'wcc': [[0.49992028756610613, 0.50007971243389382], [0.49993156519014464, 0.50006843480985541], [0.49996764080429568, 0.50003235919570432], [0.49992511900184605, 0.50007488099815389], [0.49991431388981561, 0.50008568611018456], [0.49988016171942073, 0.50011983828057927], [0.49986012747357905, 0.500139872526421], [0.4998405463720369, 0.50015945362796299], [0.4995792466052742, 0.5004207533947258], [0.49979511041314212, 0.50020488958685783], [0.49979162838437857, 0.50020837161562137], [0.49946371282280194, 0.50053628717719789], [0.49974093798914559, 0.50025906201085424], [0.49979282735701319, 0.50020717264298686], [0.49962811659067596, 0.50037188340932404], [0.49970681443691173, 0.50029318556308822], [0.49964276159016752, 0.50035723840983248], [0.49970051707579011, 0.50029948292420978], [0.49957763488907181, 0.50042236511092797], [0.49957905439586181, 0.50042094560413808], [0.4995254375417561, 0.50047456245824384], [0.49948810937191129, 0.50051189062808876], [0.49946066525387084, 0.50053933474612911], [0.49957486472014861, 0.50042513527985144], [0.49839748437472503, 0.5016025156252748], [0.49873658208794419, 0.50126341791205564], [0.49937449562388975, 0.50062550437611031], [0.49941431142409359, 0.50058568857590635], [0.49931814577505462, 0.50068185422494516], [0.4990735798870683, 0.50092642011293176], [0.49946975622903644, 0.50053024377096333], [0.49926114980441899, 0.50073885019558095], [0.49922663642946735, 0.5007733635705327], [0.49920122595221594, 0.50079877404778406], [0.49900841482520769, 0.50099158517479214], [0.49887148170768636, 0.50112851829231364], [0.49915618691890312, 0.50084381308109671], [0.49908788373221846, 0.50091211626778154], [0.49905968975377579, 0.50094031024622421], [0.49925481762928109, 0.50074518237071897], [0.49781334034124963, 0.50218665965875031], [0.49882461795223138, 0.50117538204776868], [0.4989476541110564, 0.50105234588894354], [0.49965794075110309, 0.50034205924889696], [0.49871123964576464, 0.5012887603542352], [0.49888129366384304, 0.50111870633615685], [0.49884869279660271, 0.50115130720339718], [0.49883548528355542, 0.50116451471644474], [0.49884120425047584, 0.50115879574952404], [0.4987185668094003, 0.5012814331905997], [0.49851711947256538, 0.50148288052743462], [0.49863131366630281, 0.50136868633369713], [0.49857428503324641, 0.50142571496675359], [0.4986004821463384, 0.50139951785366155], [0.49869851281151323, 0.50130148718848688], [0.49852908627195724, 0.50147091372804276], [0.49853342273286977, 0.50146657726713029], [0.49881897740665948, 0.50118102259334041], [0.49830702874180521, 0.50169297125819479], [0.49817626333155535, 0.5018237366684446], [0.49831021667858866, 0.50168978332141134], [0.49839965852305124, 0.50160034147694876], [0.49841855678604663, 0.50158144321395337], [0.49818705344616926, 0.5018129465538308], [0.49839730658091946, 0.50160269341908048], [0.49769322219935452, 0.50230677780064548], [0.49818411423051606, 0.50181588576948388], [0.49842279954884861, 0.50157720045115139], [0.49816304620359181, 0.50183695379640836], [0.4981252840556753, 0.50187471594432465], [0.49807956280161103, 0.50192043719838897], [0.49805759579881442, 0.50194240420118552], [0.49787941196702573, 0.50212058803297421], [0.49798192662863217, 0.50201807337136783], [0.49793062283016531, 0.50206937716983457], [0.49789509015337358, 0.50210490984662648], [0.49758197975463098, 0.50241802024536886], [0.49769842724445423, 0.50230157275554577], [0.49785983655378413, 0.50214016344621593], [0.49785529726846917, 0.50214470273153056], [0.4977950524280999, 0.50220494757190015], [0.49706181247898451, 0.50293818752101527], [0.4979452506189786, 0.50205474938102146], [0.49755395215878617, 0.50244604784121361], [0.49755792949189787, 0.50244207050810208], [0.49721810708653652, 0.50278189291346354], [0.4973247014737846, 0.50267529852621518], [0.49738773001510889, 0.50261226998489117], [0.49698051744040261, 0.5030194825595975], [0.49620675737824305, 0.50379324262175684], [0.49741239049258346, 0.50258760950741643], [0.4975755623356905, 0.50242443766430944], [0.49718851930119079, 0.5028114806988091], [0.49742417969467895, 0.502575820305321], [0.49708856330183138, 0.50291143669816851], [0.49720416589950905, 0.502795834100491], [0.497168335678708, 0.50283166432129178], [0.49707476316775412, 0.50292523683224588], [0.49662079316177932, 0.50337920683822057], [0.49693862543905354, 0.50306137456094657], [0.49652246862222543, 0.50347753137777462], [0.4966375979356214, 0.50336240206437854], [0.49658515075210879, 0.50341484924789115], [0.49652186674885118, 0.50347813325114876], [0.49664617680522588, 0.50335382319477406], [0.4964655963799694, 0.50353440362003066], [0.49657697056770628, 0.50342302943229367], [0.49615579139864779, 0.50384420860135215], [0.49631969019386468, 0.50368030980613521], [0.49635816667080701, 0.50364183332919277], [0.49609018178300257, 0.50390981821699743], [0.49606171799284038, 0.5039382820071594], [0.49618627153755934, 0.50381372846244066], [0.49598307409665082, 0.50401692590334912], [0.49575214283621244, 0.50424785716378739], [0.49667573842601603, 0.50332426157398391], [0.49598995867027906, 0.50401004132972083], [0.49556554903242783, 0.50443445096757211], [0.49567316349768115, 0.5043268365023188], [0.4955670854248676, 0.5044329145751324], [0.49559061196767795, 0.50440938803232194], [0.49508266673881857, 0.50491733326118127], [0.49435414223151286, 0.50564585776848714], [0.49521646598764235, 0.50478353401235765], [0.49562912092711248, 0.50437087907288736], [0.49503932784969656, 0.50496067215030349], [0.49483483953045188, 0.50516516046954818], [0.49525973078741575, 0.50474026921258419], [0.49477058127766044, 0.50522941872233973], [0.49462573339797111, 0.50537426660202889], [0.49667543595674563, 0.50332456404325443], [0.49488874449874148, 0.50511125550125846], [0.49488938691112927, 0.50511061308887073], [0.49431560988589823, 0.5056843901141016], [0.49424123937002895, 0.50575876062997094], [0.49400805833385059, 0.50599194166614936], [0.49373822593938543, 0.50626177406061446], [0.49394875770184182, 0.50605124229815801], [0.49348793998782592, 0.50651206001217408], [0.49383025506004852, 0.50616974493995148], [0.49324019586021972, 0.50675980413978028], [0.49332963873506785, 0.50667036126493203], [0.49287118727095763, 0.50712881272904231], [0.49239051790517069, 0.50760948209482915], [0.49290878510469072, 0.50709121489530917], [0.49320040579396135, 0.50679959420603859], [0.49284269382905682, 0.50715730617094312], [0.49251762549542544, 0.50748237450457456], [0.49235505744734159, 0.50764494255265835], [0.49303780623702981, 0.50696219376297003], [0.49223700688020239, 0.50776299311979756], [0.49150296788210779, 0.50849703211789232], [0.4919506448167022, 0.50804935518329786], [0.49219465631519588, 0.50780534368480423], [0.49071255167592942, 0.50928744832407036], [0.49157883413845721, 0.50842116586154273], [0.49145653538817519, 0.50854346461182476], [0.49134089346126419, 0.50865910653873581], [0.49068340006337324, 0.50931659993662659], [0.49074069616957883, 0.50925930383042117], [0.49191854779675137, 0.50808145220324863], [0.49030284813671271, 0.50969715186328712], [0.49009497927812984, 0.50990502072187005], [0.48999309564427335, 0.51000690435572649], [0.48963705555807291, 0.51036294444192709], [0.48946331278838445, 0.51053668721161571], [0.48889000803746363, 0.51110999196253648], [0.48921009498167045, 0.51078990501832955], [0.48806355055022405, 0.51193644944977601], [0.48721885620738942, 0.51278114379261053], [0.48515994504088417, 0.51484005495911567], [0.48757366875888003, 0.51242633124111991], [0.48698775084487994, 0.51301224915512011], [0.48764681181882452, 0.51235318818117537], [0.48723086622919554, 0.51276913377080424], [0.48633656309658263, 0.51366343690341743], [0.48618211214646739, 0.51381788785353266], [0.48635316196140255, 0.51364683803859734], [0.48508050092827726, 0.51491949907172274], [0.48567762714030843, 0.51432237285969151], [0.48423238077651554, 0.51576761922348446], [0.48443234997719792, 0.51556765002280192], [0.48324979384893874, 0.51675020615106115], [0.48356917491855694, 0.516430825081443], [0.48376687436716626, 0.51623312563283363], [0.4827653036623516, 0.51723469633764829], [0.48152838107235602, 0.51847161892764393], [0.48180631897827736, 0.5181936810217227], [0.48014418833067568, 0.51985581166932437], [0.48062232090866869, 0.51937767909133137], [0.48021366515252767, 0.51978633484747216], [0.47954919087933839, 0.52045080912066166], [0.4788228445663239, 0.52117715543367593], [0.4761920580081751, 0.5238079419918249], [0.47284179939137305, 0.52715820060862706], [0.47354687094810338, 0.52645312905189656], [0.47634502294351255, 0.52365497705648745], [0.47113352625683236, 0.52886647374316764], [0.47412985271485553, 0.52587014728514447], [0.47582374062907867, 0.52417625937092138], [0.47253168778008792, 0.52746831221991208], [0.47191457118061053, 0.52808542881938947], [0.46648657659536424, 0.5335134234046357], [0.4695758869857562, 0.53042411301424353], [0.47236789035945898, 0.52763210964054097], [0.46850664670141046, 0.53149335329858949], [0.46593986493572326, 0.53406013506427663], [0.46473367725170217, 0.53526632274829788], [0.46494388389438918, 0.53505611610561066], [0.4632268214424029, 0.5367731785575971], [0.46152089509612582, 0.53847910490387418], [0.45845064764272619, 0.54154935235727386], [0.45661561693002145, 0.54338438306997849], [0.45477706148072355, 0.54522293851927639], [0.45470935923080041, 0.54529064076919953], [0.45137528157015411, 0.54862471842984584], [0.45101111185254927, 0.54898888814745073], [0.44591210054237673, 0.55408789945762338], [0.4475015979118368, 0.55249840208816314], [0.4408896942344066, 0.55911030576559351], [0.43915928375820718, 0.56084071624179277], [0.43518202285342661, 0.56481797714657334], [0.43187044898534899, 0.56812955101465101], [0.42883660544330404, 0.57116339455669562], [0.42521636351232983, 0.57478363648767006], [0.42294827375452426, 0.57705172624547563], [0.41489732984118133, 0.58510267015881867], [0.41367039813523415, 0.58632960186476579], [0.40983168644122725, 0.59016831355877286], [0.40583323238849983, 0.59416676761150033], [0.39969762396600983, 0.60030237603399028], [0.39889985886742629, 0.60110014113257382], [0.3891728992368737, 0.6108271007631263], [0.39119559748284138, 0.60880440251715862], [0.38110529789874159, 0.61889470210125841], [0.3779707849367186, 0.62202921506328124], [0.37328215092202821, 0.62671784907797168], [0.36637815469541452, 0.63362184530458543], [0.36081189865948504, 0.63918810134051496], [0.36019057645077729, 0.63980942354922288], [0.34688607529219367, 0.65311392470780616], [0.33880313833025416, 0.66119686166974567], [0.33436452083663698, 0.66563547916336308], [0.32845500092119184, 0.67154499907880827], [0.32259717084072215, 0.67740282915927785], [0.3155057916395349, 0.68449420836046504], [0.30857731007944439, 0.69142268992055544], [0.30435100145010968, 0.69564899854989015], [0.29759488687029934, 0.70240511312970055], [0.29491451602263496, 0.70508548397736515], [0.28314206017716081, 0.71685793982283896], [0.27629011132884723, 0.7237098886711526], [0.26995275320111545, 0.73004724679888455], [0.26342947631428171, 0.73657052368571818], [0.25737465210972865, 0.74262534789027135], [0.25061951424418583, 0.74938048575581417], [0.24432083516557437, 0.75567916483442554], [0.23636475980158311, 0.763635240198417], [0.23215674309055107, 0.76784325690944877], [0.22428859081489586, 0.77571140918510428], [0.21576373130588031, 0.78423626869411978], [0.20718034191453502, 0.79281965808546506], [0.20664147189707488, 0.7933585281029254], [0.201564379021659, 0.79843562097834109], [0.19238144971452345, 0.80761855028547647], [0.19023151288366311, 0.80976848711633675], [0.18480972084683114, 0.81519027915316888], [0.17793316848677918, 0.82206683151322091], [0.17068884661316533, 0.82931115338683459], [0.16518030830148062, 0.83481969169851933], [0.160746650926887, 0.83925334907311311], [0.1522665287846989, 0.84773347121530118], [0.14918605819303055, 0.85081394180696956], [0.1453412805398957, 0.85465871946010441], [0.13895207125798159, 0.8610479287420183], [0.13061095602584474, 0.86938904397415517], [0.12890955232335177, 0.87109044767664845], [0.12307768541352519, 0.87692231458647463], [0.11795112975882997, 0.88204887024116996], [0.11290138349034592, 0.88709861650965394], [0.10845449818402926, 0.8915455018159707], [0.10267561210075792, 0.89732438789924207], [0.09756705646776298, 0.90243294353223713], [0.093269442447694501, 0.90673055755230547], [0.089047105805027504, 0.9109528941949725], [0.084485266713248741, 0.91551473328675126], [0.079450945027018507, 0.92054905497298145], [0.074987277789102316, 0.92501272221089759], [0.070077611884972288, 0.9299223881150277], [0.0649199749270713, 0.93508002507292864], [0.060941169984654431, 0.93905883001534562], [0.057219077900943237, 0.94278092209905662], [0.052412815582856376, 0.94758718441714385], [0.046905022334894464, 0.95309497766510543], [0.043714236487800713, 0.95628576351219929], [0.038216020503243922, 0.96178397949675609], [0.035462172685889491, 0.96453782731411042], [0.030520240473739243, 0.96947975952626075], [0.026855331314780205, 0.97314466868521976], [0.021559441042279918, 0.97844055895771997], [0.017267030219661385, 0.98273296978033864], [0.012820861490106247, 0.98717913850989392], [0.0082979269454312304, 0.99170207305456892], [0.0042312500136727918, 0.99576874998632725], [0.00038870075377931372, 0.9996112992462205]], 'lambda_': [array([[ -9.99999875e-01 +5.00228488e-04j,
         -2.49028322e-05 -1.30104261e-18j],
       [  2.49028322e-05 +2.22044605e-16j,
         -9.99999875e-01 -5.00228488e-04j]]), array([[ -9.99999908e-01+0.00025651j,  -4.50091651e-05-0.00034215j],
       [  4.50091651e-05-0.00034215j,  -9.99999908e-01-0.00025651j]]), array([[ -9.99999979e-01 +1.97128968e-04j,
         -7.99129195e-06 -4.91411485e-05j],
       [  7.99129195e-06 -4.91411485e-05j,
         -9.99999979e-01 -1.97128968e-04j]]), array([[ -9.99999889e-01+0.00018697j,  -1.91064613e-04+0.00038717j],
       [  1.91064613e-04+0.00038717j,  -9.99999889e-01-0.00018697j]]), array([[ -9.99999855e-01 +8.69760252e-05j,
          9.54678030e-05 +5.22662325e-04j],
       [ -9.54678030e-05 +5.22662325e-04j,
         -9.99999855e-01 -8.69760252e-05j]]), array([[ -9.99999717e-01 +7.52965890e-04j,
         -4.60425790e-07 -1.80189790e-07j],
       [  4.60425790e-07 -1.80189789e-07j,
         -9.99999717e-01 -7.52965890e-04j]]), array([[ -9.99999614e-01 +8.78836727e-04j,
          3.88379482e-07 -3.76796465e-06j],
       [ -3.88379482e-07 -3.76796465e-06j,
         -9.99999614e-01 -8.78836727e-04j]]), array([[ -9.99999498e-01+0.0009911j ,  -2.04174209e-05-0.00014514j],
       [  2.04174209e-05-0.00014514j,  -9.99999498e-01-0.0009911j ]]), array([[ -9.99996506e-01 +2.63357320e-03j,
         -2.26689549e-04 +4.34398998e-05j],
       [  2.26689549e-04 +4.34398998e-05j,
         -9.99996506e-01 -2.63357320e-03j]]), array([[ -9.99999171e-01 +1.28733565e-03j,
          7.43836272e-06 -2.12304319e-06j],
       [ -7.43836272e-06 -2.12304319e-06j,
         -9.99999171e-01 -1.28733565e-03j]]), array([[ -9.99999143e-01 +1.30911620e-03j,
          1.73752028e-05 +3.82789752e-06j],
       [ -1.73752028e-05 +3.82789752e-06j,
         -9.99999143e-01 -1.30911620e-03j]]), array([[ -9.99994323e-01 +3.36434578e-03j,
         -1.78813264e-04 +5.75204960e-05j],
       [  1.78813264e-04 +5.75204960e-05j,
         -9.99994323e-01 -3.36434578e-03j]]), array([[ -9.99998675e-01+0.00157325j,  -3.70507415e-05+0.00041596j],
       [  3.70507415e-05+0.00041596j,  -9.99998675e-01-0.00157325j]]), array([[ -9.99999153e-01 +1.29908050e-03j,
          7.52296989e-05 -3.41024107e-05j],
       [ -7.52296989e-05 -3.41024107e-05j,
         -9.99999153e-01 -1.29908050e-03j]]), array([[ -9.99997270e-01 +2.33620523e-03j,
          5.50942483e-06 +4.31532173e-05j],
       [ -5.50942483e-06 +4.31532173e-05j,
         -9.99997270e-01 -2.33620523e-03j]]), array([[ -9.99998303e-01+0.00073433j,  -1.54288071e-04+0.00168239j],
       [  1.54288071e-04+0.00168239j,  -9.99998303e-01-0.00073433j]]), array([[ -9.99997481e-01+0.00223902j,   7.79392241e-05-0.00013747j],
       [ -7.79392241e-05-0.00013747j,  -9.99997481e-01-0.00223902j]]), array([[ -9.99998230e-01+0.00185928j,   1.74353597e-04+0.0002313j ],
       [ -1.74353597e-04+0.0002313j ,  -9.99998230e-01-0.00185928j]]), array([[ -9.99996479e-01 +2.65339343e-03j,
         -2.48312856e-05 -3.89281426e-05j],
       [  2.48312856e-05 -3.89281426e-05j,
         -9.99996479e-01 -2.65339343e-03j]]), array([[ -9.99996502e-01+0.00251449j,   2.37692562e-04-0.00078499j],
       [ -2.37692562e-04-0.00078499j,  -9.99996502e-01-0.00251449j]]), array([[ -9.99995555e-01 +2.98175945e-03j,
          7.35508099e-10 -5.97208226e-10j],
       [ -7.35508082e-10 -5.97208397e-10j,
         -9.99995555e-01 -2.98175945e-03j]]), array([[ -9.99994828e-01 +3.21622795e-03j,
         -1.82314387e-05 -1.09096207e-05j],
       [  1.82314387e-05 -1.09096207e-05j,
         -9.99994828e-01 -3.21622795e-03j]]), array([[ -9.99994258e-01 +3.38873112e-03j,
         -4.14708064e-06 -2.24758233e-07j],
       [  4.14708064e-06 -2.24758233e-07j,
         -9.99994258e-01 -3.38873112e-03j]]), array([[ -9.99996432e-01+0.00265075j,  -1.49202415e-05-0.00032954j],
       [  1.49202415e-05-0.00032954j,  -9.99996432e-01-0.00265075j]]), array([[-0.99994931+0.00996447j, -0.00137327+0.00045031j],
       [ 0.00137327+0.00045031j, -0.99994931-0.00996447j]]), array([[ -9.99968492e-01+0.00788219j,  -2.77588416e-04-0.00089949j],
       [  2.77588416e-04-0.00089949j,  -9.99968492e-01-0.00788219j]]), array([[ -9.99992277e-01 +3.93014002e-03j,
         -3.13486266e-07 +8.75650998e-06j],
       [  3.13486266e-07 +8.75650998e-06j,
         -9.99992277e-01 -3.93014002e-03j]]), array([[ -9.99993229e-01 +3.67860934e-03j,
          2.08390543e-05 -9.83017290e-05j],
       [ -2.08390543e-05 -9.83017290e-05j,
         -9.99993229e-01 -3.67860934e-03j]]), array([[ -9.99990823e-01+0.00428166j,  -6.01610211e-05-0.00013467j],
       [  6.01610211e-05-0.00013467j,  -9.99990823e-01-0.00428166j]]), array([[ -9.99983059e-01 +5.81916177e-03j,
         -1.38221032e-04 +1.96787480e-05j],
       [  1.38221032e-04 +1.96787480e-05j,
         -9.99983059e-01 -5.81916177e-03j]]), array([[ -9.99994450e-01 +3.32951978e-03j,
          6.84672251e-05 -9.62299154e-05j],
       [ -6.84672251e-05 -9.62299154e-05j,
         -9.99994450e-01 -3.32951978e-03j]]), array([[ -9.99989224e-01 +4.64227018e-03j,
          1.25904337e-07 +2.06295926e-05j],
       [ -1.25904336e-07 +2.06295926e-05j,
         -9.99989224e-01 -4.64227018e-03j]]), array([[ -9.99988194e-01 +4.85916748e-03j,
          2.74562722e-07 -3.49934562e-07j],
       [ -2.74562723e-07 -3.49934562e-07j,
         -9.99988194e-01 -4.85916748e-03j]]), array([[ -9.99987406e-01 +5.01849528e-03j,
         -5.67011463e-05 +9.34587767e-06j],
       [  5.67011463e-05 +9.34587767e-06j,
         -9.99987406e-01 -5.01849528e-03j]]), array([[ -9.99980592e-01+0.00622844j,  -1.00078456e-04-0.00011306j],
       [  1.00078456e-04-0.00011306j,  -9.99980592e-01-0.00622844j]]), array([[ -9.99974861e-01+0.00706362j,  -2.29875331e-04+0.000574j  ],
       [  2.29875331e-04+0.000574j  ,  -9.99974861e-01-0.00706362j]]), array([[ -9.99985945e-01+0.00526474j,  -1.04358812e-04-0.00061712j],
       [  1.04358812e-04-0.00061712j,  -9.99985945e-01-0.00526474j]]), array([[ -9.99983578e-01 +5.73038171e-03j,
         -5.53210560e-05 -6.01271088e-05j],
       [  5.53210560e-05 -6.01271088e-05j,
         -9.99983578e-01 -5.73038171e-03j]]), array([[ -9.99982547e-01 +5.90746571e-03j,
         -8.71577148e-05 -2.49351645e-06j],
       [  8.71577148e-05 -2.49351645e-06j,
         -9.99982547e-01 -5.90746571e-03j]]), array([[ -9.99989039e-01+0.00467597j,   9.00108364e-05-0.00022194j],
       [ -9.00108364e-05-0.00022194j,  -9.99989039e-01-0.00467597j]]), array([[-0.99990562+0.01350039j, -0.00150055+0.00205941j],
       [ 0.00150055+0.00205941j, -0.99990562-0.01350039j]]), array([[ -9.99972730e-01 +7.38384895e-03j,
         -1.33154415e-04 -1.98314410e-05j],
       [  1.33154415e-04 -1.98314410e-05j,
         -9.99972730e-01 -7.38384895e-03j]]), array([[ -9.99978140e-01 +6.61137180e-03j,
         -9.37206074e-05 -2.02365135e-07j],
       [  9.37206074e-05 -2.02365135e-07j,
         -9.99978140e-01 -6.61137180e-03j]]), array([[ -9.99997690e-01+0.00065909j,  -8.75636648e-05+0.00204379j],
       [  8.75636648e-05+0.00204379j,  -9.99997690e-01-0.00065909j]]), array([[ -9.99967215e-01+0.00800816j,  -4.00117156e-04-0.00113035j],
       [  4.00117156e-04-0.00113035j,  -9.99967215e-01-0.00800816j]]), array([[ -9.99975296e-01 +7.02873112e-03j,
         -5.80554861e-05 -1.21211158e-05j],
       [  5.80554861e-05 -1.21211158e-05j,
         -9.99975296e-01 -7.02873112e-03j]]), array([[ -9.99973836e-01 +7.23314623e-03j,
         -9.43226117e-05 -2.74836930e-05j],
       [  9.43226117e-05 -2.74836930e-05j,
         -9.99973836e-01 -7.23314623e-03j]]), array([[ -9.99973232e-01 +7.31644668e-03j,
         -5.68138024e-05 -4.34822582e-05j],
       [  5.68138024e-05 -4.34822582e-05j,
         -9.99973232e-01 -7.31644668e-03j]]), array([[ -9.99973494e-01+0.00727606j,   3.36656964e-06+0.00026439j],
       [ -3.36656964e-06+0.00026439j,  -9.99973494e-01-0.00727606j]]), array([[ -9.99967587e-01+0.00804944j,  -4.61418572e-05+0.00017117j],
       [  4.61418572e-05+0.00017117j,  -9.99967587e-01-0.00804944j]]), array([[ -9.99956595e-01 +9.31548466e-03j,
         -1.63164530e-04 +5.54224575e-05j],
       [  1.63164530e-04 +5.54224575e-05j,
         -9.99956595e-01 -9.31548466e-03j]]), array([[ -9.99963023e-01 +8.59912082e-03j,
         -8.93574927e-05 +1.79699165e-05j],
       [  8.93574927e-05 +1.79699165e-05j,
         -9.99963023e-01 -8.59912082e-03j]]), array([[ -9.99959877e-01+0.0089568j,  -3.29794204e-05-0.000137j ],
       [  3.29794204e-05-0.000137j ,  -9.99959877e-01-0.0089568j]]), array([[ -9.99961338e-01 +8.79264113e-03j,
         -7.35818560e-05 +8.04117351e-05j],
       [  7.35818560e-05 +8.04117351e-05j,
         -9.99961338e-01 -8.79264113e-03j]]), array([[ -9.99966565e-01 +8.17490670e-03j,
          2.00192209e-04 -2.44298948e-05j],
       [ -2.00192209e-04 -2.44298948e-05j,
         -9.99966565e-01 -8.17490670e-03j]]), array([[ -9.99957293e-01 +9.23933165e-03j,
         -2.17465309e-04 +5.13553470e-06j],
       [  2.17465309e-04 +5.13553470e-06j,
         -9.99957293e-01 -9.23933165e-03j]]), array([[ -9.99957544e-01 +9.21304644e-03j,
         -1.71281370e-04 -1.20376126e-05j],
       [  1.71281370e-04 -1.20376126e-05j,
         -9.99957544e-01 -9.21304644e-03j]]), array([[ -9.99972468e-01+0.00736139j,  -6.43228838e-04+0.0006784j ],
       [  6.43228838e-04+0.0006784j ,  -9.99972468e-01-0.00736139j]]), array([[ -9.99943425e-01+0.01063344j,  -2.49638460e-04+0.00012039j],
       [  2.49638460e-04+0.00012039j,  -9.99943425e-01-0.01063344j]]), array([[ -9.99934348e-01 +1.14499467e-02j,
         -4.45126362e-04 -2.57316185e-05j],
       [  4.45126362e-04 -2.57316185e-05j,
         -9.99934348e-01 -1.14499467e-02j]]), array([[ -9.99943638e-01 +1.06169008e-02j,
         -4.87922402e-05 +1.40943172e-05j],
       [  4.87922402e-05 +1.40943172e-05j,
         -9.99943638e-01 -1.06169008e-02j]]), array([[ -9.99949446e-01 +1.00550726e-02j,
          1.29093511e-07 +2.87708057e-07j],
       [ -1.29093511e-07 +2.87708057e-07j,
         -9.99949446e-01 -1.00550726e-02j]]), array([[ -9.99950633e-01 +9.93631782e-03j,
          1.39207393e-05 -1.38701092e-05j],
       [ -1.39207393e-05 -1.38701092e-05j,
         -9.99950633e-01 -9.93631782e-03j]]), array([[ -9.99935122e-01+0.01138932j,  -2.04773845e-05-0.00018441j],
       [  2.04773845e-05-0.00018441j,  -9.99935122e-01-0.01138932j]]), array([[ -9.99949298e-01+0.01006533j,  -1.08270352e-04-0.00028172j],
       [  1.08270352e-04-0.00028172j,  -9.99949298e-01-0.01006533j]]), array([[ -9.99894965e-01+0.01448102j,  -5.73842573e-04+0.00017175j],
       [  5.73842573e-04+0.00017175j,  -9.99894965e-01-0.01448102j]]), array([[ -9.99934912e-01 +1.14047813e-02j,
         -3.21034867e-04 +2.89359544e-06j],
       [  3.21034867e-04 +2.89359544e-06j,
         -9.99934912e-01 -1.14047813e-02j]]), array([[ -9.99950898e-01+0.00989218j,   3.56838984e-04+0.00046813j],
       [ -3.56838984e-04+0.00046813j,  -9.99950898e-01-0.00989218j]]), array([[ -9.99933393e-01 +1.15416648e-02j,
         -1.10165102e-07 +1.34818289e-08j],
       [  1.10165102e-07 +1.34818289e-08j,
         -9.99933393e-01 -1.15416648e-02j]]), array([[ -9.99930626e-01 +1.17789147e-02j,
         -3.95863365e-07 -3.84654645e-06j],
       [  3.95863364e-07 -3.84654645e-06j,
         -9.99930626e-01 -1.17789147e-02j]]), array([[ -9.99927201e-01 +1.20643722e-02j,
         -2.07673553e-04 +1.59216578e-05j],
       [  2.07673553e-04 +1.59216578e-05j,
         -9.99927201e-01 -1.20643722e-02j]]), array([[ -9.99925526e-01 +1.22041825e-02j,
          4.75619513e-07 -1.41485340e-06j],
       [ -4.75619513e-07 -1.41485340e-06j,
         -9.99925526e-01 -1.22041825e-02j]]), array([[ -9.99911236e-01 +1.33082664e-02j,
          6.36926867e-04 -6.41008180e-05j],
       [ -6.36926867e-04 -6.41008180e-05j,
         -9.99911236e-01 -1.33082664e-02j]]), array([[ -9.99919611e-01 +1.26795888e-02j,
         -3.07303274e-07 -2.90574377e-06j],
       [  3.07303274e-07 -2.90574377e-06j,
         -9.99919611e-01 -1.26795888e-02j]]), array([[ -9.99915472e-01 +1.30014309e-02j,
         -1.09510396e-04 +2.37754795e-05j],
       [  1.09510396e-04 +2.37754795e-05j,
         -9.99915472e-01 -1.30014309e-02j]]), array([[ -9.99912544e-01 +1.32251529e-02j,
         -1.48358912e-06 -1.58792592e-06j],
       [  1.48358912e-06 -1.58792592e-06j,
         -9.99912544e-01 -1.32251529e-02j]]), array([[ -9.99884591e-01 +1.51913271e-02j,
         -1.60472683e-04 -5.78474015e-05j],
       [  1.60472683e-04 -5.78474015e-05j,
         -9.99884591e-01 -1.51913271e-02j]]), array([[ -9.99895439e-01 +1.44606250e-02j,
         -2.94528443e-05 +3.76869811e-05j],
       [  2.94528443e-05 +3.76869811e-05j,
         -9.99895439e-01 -1.44606250e-02j]]), array([[ -9.99909590e-01 +1.34411410e-02j,
         -3.78358727e-04 +6.82286093e-05j],
       [  3.78358727e-04 +6.82286093e-05j,
         -9.99909590e-01 -1.34411410e-02j]]), array([[ -9.99909206e-01 +1.34714289e-02j,
         -3.16076287e-04 -2.34757825e-05j],
       [  3.16076287e-04 -2.34757825e-05j,
         -9.99909206e-01 -1.34714289e-02j]]), array([[ -9.99904034e-01 +1.38484055e-02j,
         -3.81121383e-04 -7.69392891e-06j],
       [  3.81121383e-04 -7.69392891e-06j,
         -9.99904034e-01 -1.38484055e-02j]]), array([[ -9.99829597e-01 +1.84534888e-02j,
         -4.94955565e-04 -9.82436347e-06j],
       [  4.94955565e-04 -9.82436347e-06j,
         -9.99829597e-01 -1.84534888e-02j]]), array([[ -9.99916662e-01+0.01290068j,  -4.06168042e-04-0.00027549j],
       [  4.06168042e-04-0.00027549j,  -9.99916662e-01-0.01290068j]]), array([[ -9.99881900e-01+0.0153658j ,  -2.48312736e-04+0.00013182j],
       [  2.48312736e-04+0.00013182j,  -9.99881900e-01-0.0153658j ]]), array([[ -9.99882283e-01+0.01533648j,   2.45050156e-04+0.00038937j],
       [ -2.45050156e-04+0.00038937j,  -9.99882283e-01-0.01533648j]]), array([[ -9.99847244e-01+0.01747644j,  -2.03925100e-04-0.00014881j],
       [  2.03925100e-04-0.00014881j,  -9.99847244e-01-0.01747644j]]), array([[ -9.99858725e-01+0.0168038j ,   3.57699394e-04+0.00018337j],
       [ -3.57699394e-04+0.00018337j,  -9.99858725e-01-0.0168038j ]]), array([[ -9.99865304e-01+0.01640775j,  -2.38277149e-04-0.00032184j],
       [  2.38277149e-04-0.00032184j,  -9.99865304e-01-0.01640775j]]), array([[ -9.99820038e-01+0.01896103j,  -5.87704492e-04-0.00016201j],
       [  5.87704492e-04-0.00016201j,  -9.99820038e-01-0.01896103j]]), array([[-0.99971599+0.02342746j, -0.00163619-0.00405121j],
       [ 0.00163619-0.00405121j, -0.99971599-0.02342746j]]), array([[ -9.99867835e-01 +1.62574498e-02j,
          8.81957577e-05 -2.83436072e-05j],
       [ -8.81957577e-05 -2.83436072e-05j,
         -9.99867835e-01 -1.62574498e-02j]]), array([[ -9.99883977e-01+0.01522192j,  -5.53560698e-04+0.00013772j],
       [  5.53560698e-04+0.00013772j,  -9.99883977e-01-0.01522192j]]), array([[ -9.99843977e-01+0.0176635j ,  -4.67546036e-05-0.00014248j],
       [  4.67546036e-05-0.00014248j,  -9.99843977e-01-0.0176635j ]]), array([[ -9.99869036e-01+0.01617107j,  -4.73617725e-05+0.0006363j ],
       [  4.73617725e-05+0.0006363j ,  -9.99869036e-01-0.01617107j]]), array([[ -9.99832686e-01+0.0182911j ,   7.39744149e-05-0.00017434j],
       [ -7.39744149e-05-0.00017434j,  -9.99832686e-01-0.0182911j ]]), array([[ -9.99845709e-01+0.01756547j,  -1.91651975e-05+0.00011242j],
       [  1.91651975e-05+0.00011242j,  -9.99845709e-01-0.01756547j]]), array([[ -9.99841729e-01+0.01775502j,  -6.86494896e-04-0.00089735j],
       [  6.86494896e-04-0.00089735j,  -9.99841729e-01-0.01775502j]]), array([[ -9.99831096e-01+0.01835752j,  -7.72008772e-04+0.00042967j],
       [  7.72008772e-04+0.00042967j,  -9.99831096e-01-0.01835752j]]), array([[ -9.99774606e-01 +2.12079903e-02j,
         -9.79109398e-04 +1.83721094e-05j],
       [  9.79109398e-04 +1.83721094e-05j,
         -9.99774606e-01 -2.12079903e-02j]]), array([[ -9.99815010e-01 +1.92337810e-02j,
         -8.64375557e-05 +2.92788908e-05j],
       [  8.64375557e-05 +2.92788908e-05j,
         -9.99815010e-01 -1.92337810e-02j]]), array([[ -9.99761299e-01+0.02184508j,  -2.87460253e-04-0.00023486j],
       [  2.87460253e-04-0.00023486j,  -9.99761299e-01-0.02184508j]]), array([[ -9.99776842e-01+0.02111901j,   4.49031226e-04+0.00022865j],
       [ -4.49031226e-04+0.00022865j,  -9.99776842e-01-0.02111901j]]), array([[ -9.99769826e-01+0.02144914j,  -4.67046010e-04-0.00010472j],
       [  4.67046010e-04-0.00010472j,  -9.99769826e-01-0.02144914j]]), array([[ -9.99761216e-01+0.02184033j,  -6.03788607e-04-0.0003819j ],
       [  6.03788607e-04-0.0003819j ,  -9.99761216e-01-0.02184033j]]), array([[ -9.99777979e-01 +2.10682494e-02j,
         -3.47274777e-04 +3.02963504e-05j],
       [  3.47274777e-04 +3.02963504e-05j,
         -9.99777979e-01 -2.10682494e-02j]]), array([[ -9.99753428e-01+0.02219877j,  -3.11703515e-04-0.00044854j],
       [  3.11703515e-04-0.00044854j,  -9.99753428e-01-0.02219877j]]), array([[ -9.99768722e-01+0.02149323j,   6.95955479e-04+0.00024282j],
       [ -6.95955479e-04+0.00024282j,  -9.99768722e-01-0.02149323j]]), array([[ -9.99708309e-01+0.02414856j,  -3.57672044e-04+0.00012437j],
       [  3.57672044e-04+0.00012437j,  -9.99708309e-01-0.02414856j]]), array([[ -9.99732651e-01+0.02312168j,  -2.92160514e-05-0.00012036j],
       [  2.92160514e-05-0.00012036j,  -9.99732651e-01-0.02312168j]]), array([[ -9.99738211e-01+0.02287938j,  -7.77977225e-05+0.00019201j],
       [  7.77977225e-05+0.00019201j,  -9.99738211e-01-0.02287938j]]), array([[ -9.99698268e-01+0.02455695j,   4.39938582e-04-0.00036762j],
       [ -4.39938582e-04-0.00036762j,  -9.99698268e-01-0.02455695j]]), array([[ -9.99693859e-01+0.02474214j,   3.35949829e-06+0.00012048j],
       [ -3.35949829e-06+0.00012048j,  -9.99693859e-01-0.02474214j]]), array([[ -9.99712916e-01 +2.39590221e-02j,
         -2.24011811e-04 +2.92622476e-06j],
       [  2.24011811e-04 +2.92622476e-06j,
         -9.99712916e-01 -2.39590221e-02j]]), array([[ -9.99681511e-01+0.02522927j,  -5.74486561e-04+0.00017424j],
       [  5.74486561e-04+0.00017424j,  -9.99681511e-01-0.02522927j]]), array([[ -9.99643841e-01+0.02668224j,  -3.59405772e-04-0.00034603j],
       [  3.59405772e-04-0.00034603j,  -9.99643841e-01-0.02668224j]]), array([[ -9.99781876e-01+0.02087999j,  -4.61404771e-04-0.00012093j],
       [  4.61404771e-04-0.00012093j,  -9.99781876e-01-0.02087999j]]), array([[ -9.99682602e-01+0.02518532j,  -2.43968643e-04-0.0005796j ],
       [  2.43968643e-04-0.0005796j ,  -9.99682602e-01-0.02518532j]]), array([[-0.99961187 +2.78315103e-02j, -0.00123307 +5.78065944e-05j],
       [ 0.00123307 +5.78065944e-05j, -0.99961187 -2.78315103e-02j]]), array([[ -9.99630475e-01+0.02716747j,  -9.06599507e-04-0.00014178j],
       [  9.06599507e-04-0.00014178j,  -9.99630475e-01-0.02716747j]]), array([[ -9.99612135e-01 +2.78400804e-02j,
         -7.10905809e-04 -6.11223222e-05j],
       [  7.10905809e-04 -6.11223222e-05j,
         -9.99612135e-01 -2.78400804e-02j]]), array([[ -9.99616241e-01+0.02768502j,   9.23219347e-04+0.00024115j],
       [ -9.23219347e-04+0.00024115j,  -9.99616241e-01-0.02768502j]]), array([[-0.99952274+0.03084476j, -0.00150778-0.00078648j],
       [ 0.00150778-0.00078648j, -0.99952274-0.03084476j]]), array([[-0.99937086+0.03540858j,  0.00131473-0.00154236j],
       [-0.00131473-0.00154236j, -0.99937086-0.03540858j]]), array([[-0.99954836+0.03002595j, -0.00114536-0.00045955j],
       [ 0.00114536-0.00045955j, -0.99954836-0.03002595j]]), array([[ -9.99622914e-01+0.02740576j,  -3.95932516e-04-0.0016723j ],
       [  3.95932516e-04-0.0016723j ,  -9.99622914e-01-0.02740576j]]), array([[ -9.99514292e-01+0.0311526j ,  -8.27078252e-04+0.00011154j],
       [  8.27078252e-04+0.00011154j,  -9.99514292e-01-0.0311526j ]]), array([[ -9.99473426e-01+0.03241704j,  -2.07880036e-04+0.00140085j],
       [  2.07880036e-04+0.00140085j,  -9.99473426e-01-0.03241704j]]), array([[-0.99955649+0.02975969j,  0.00104753+0.00029531j],
       [-0.00104753+0.00029531j, -0.99955649-0.02975969j]]), array([[ -9.99460244e-01+0.03283796j,  -9.36303239e-04-0.00011214j],
       [  9.36303239e-04-0.00011214j,  -9.99460244e-01-0.03283796j]]), array([[ -9.99429932e-01 +3.37609650e-02j,
         -3.76949594e-05 -8.61912008e-05j],
       [  3.76949594e-05 -8.61912008e-05j,
         -9.99429932e-01 -3.37609650e-02j]]), array([[-0.99978184+0.02063127j,  0.00151677-0.00288631j],
       [-0.00151677-0.00288631j, -0.99978184-0.02063127j]]), array([[-0.99948436+0.03208365j,  0.00127764-0.00015427j],
       [-0.00127764-0.00015427j, -0.99948436-0.03208365j]]), array([[ -9.99484488e-01+0.03208631j,  -9.51644066e-04+0.00056609j],
       [  9.51644066e-04+0.00056609j,  -9.99484488e-01-0.03208631j]]), array([[ -9.99362249e-01+0.03570823j,  -1.35551564e-05+0.0001342j ],
       [  1.35551564e-05+0.0001342j ,  -9.99362249e-01-0.03570823j]]), array([[-0.99934545+0.03614834j,  0.00104458-0.00093302j],
       [-0.00104458-0.00093302j, -0.99934545-0.03614834j]]), array([[ -9.99291380e-01 +3.76395289e-02j,
         -6.57485674e-05 +4.08764551e-06j],
       [  6.57485674e-05 +4.08764551e-06j,
         -9.99291380e-01 -3.76395289e-02j]]), array([[ -9.99226129e-01 +3.93332004e-02j,
         -1.85680864e-04 -8.80655027e-05j],
       [  1.85680864e-04 -8.80655027e-05j,
         -9.99226129e-01 -3.93332004e-02j]]), array([[ -9.99277286e-01 +3.80096608e-02j,
         -4.14068306e-04 -7.21529682e-06j],
       [  4.14068306e-04 -7.21529682e-06j,
         -9.99277286e-01 -3.80096608e-02j]]), array([[-0.99916304+0.04087352j,  0.00159581-0.00018127j],
       [-0.00159581-0.00018127j, -0.99916304-0.04087352j]]), array([[-0.99924871 +3.87326127e-02j, -0.00134298 -6.46223383e-05j],
       [ 0.00134298 -6.46223383e-05j, -0.99924871 -3.87326127e-02j]]), array([[-0.99909815+0.04242466j, -0.00163687-0.00059087j],
       [ 0.00163687-0.00059087j, -0.99909815-0.04242466j]]), array([[-0.99912186+0.04187876j,  0.00127691-0.00022891j],
       [-0.00127691-0.00022891j, -0.99912186-0.04187876j]]), array([[-0.99899702 +4.47601753e-02j,  0.00121546 +5.16278849e-06j],
       [-0.00121546 +5.16278849e-06j, -0.99899702 -4.47601753e-02j]]), array([[-0.99885723+0.04778211j,  0.00102530-0.00020998j],
       [-0.00102530-0.00020998j, -0.99885723-0.04778211j]]), array([[-0.99900757+0.04452079j, -0.00132218-0.00015174j],
       [ 0.00132218-0.00015174j, -0.99900757-0.04452079j]]), array([[ -9.99087507e-01+0.04270562j,  -5.97824858e-04+0.00016362j],
       [  5.97824858e-04+0.00016362j,  -9.99087507e-01-0.04270562j]]), array([[-0.99898899+0.04491445j,  0.00138604-0.00133058j],
       [-0.00138604-0.00133058j, -0.99898899-0.04491445j]]), array([[-0.99889509 +4.69787394e-02j,  0.00126715 -1.82180886e-05j],
       [-0.00126715 -1.82180886e-05j, -0.99889509 -4.69787394e-02j]]), array([[-0.99884656+0.04798983j,  0.00158205+0.00014509j],
       [-0.00158205+0.00014509j, -0.99884656-0.04798983j]]), array([[-0.99904335+0.04371641j,  0.00111414+0.0001323j ],
       [-0.00111414+0.0001323j , -0.99904335-0.04371641j]]), array([[-0.99881067+0.04873905j, -0.00119172+0.00057319j],
       [ 0.00119172+0.00057319j, -0.99881067-0.04873905j]]), array([[-0.99857518+0.05327238j, -0.00197497-0.00240211j],
       [ 0.00197497-0.00240211j, -0.99857518-0.05327238j]]), array([[-0.99872133+0.05055403j,  0.00000000+0.j        ],
       [ 0.00000000+0.j        , -0.99872133-0.05055403j]]), array([[ -9.98797661e-01+0.04901578j,  -6.30589250e-04+0.0005357j ],
       [  6.30589250e-04+0.0005357j ,  -9.98797661e-01-0.04901578j]]), array([[-0.99829784+0.05823669j, -0.00311218+0.00046487j],
       [ 0.00311218+0.00046487j, -0.99829784-0.05823669j]]), array([[-0.99860050+0.05270643j,  0.00436136+0.00022697j],
       [-0.00436136+0.00022697j, -0.99860050-0.05270643j]]), array([[-0.99855957 +5.36268436e-02j, -0.00171909 -2.11669713e-05j],
       [ 0.00171909 -2.11669713e-05j, -0.99855957 -5.36268436e-02j]]), array([[-0.99852032+0.0543216j ,  0.00177233+0.00178893j],
       [-0.00177233+0.00178893j, -0.99852032-0.0543216j ]]), array([[-0.99828714 +5.83110651e-02j,  0.00475352 -3.03811801e-06j],
       [-0.00475352 -3.03811801e-06j, -0.99828714 -5.83110651e-02j]]), array([[-0.99830814 +5.81130230e-02j, -0.00193094 +4.09956817e-05j],
       [ 0.00193094 +4.09956817e-05j, -0.99830814 -5.81130230e-02j]]), array([[-0.99871111+0.05036601j, -0.00580248-0.00238974j],
       [ 0.00580248-0.00238974j, -0.99871111-0.05036601j]]), array([[ -9.98144403e-01 +6.08913021e-02j,
         -7.53199394e-06 +3.18169718e-05j],
       [  7.53199394e-06 +3.18169718e-05j,
         -9.98144403e-01 -6.08913021e-02j]]), array([[-0.99806402+0.06213473j,  0.00272741-0.00020808j],
       [-0.00272741-0.00020808j, -0.99806402-0.06213473j]]), array([[ -9.98024004e-01+0.06282691j,  -4.73392320e-04+0.00080248j],
       [  4.73392320e-04+0.00080248j,  -9.98024004e-01-0.06282691j]]), array([[ -9.97880943e-01 +6.50662510e-02j,
          6.98080506e-05 +4.12528246e-05j],
       [ -6.98080506e-05 +4.12528246e-05j,
         -9.97880943e-01 -6.50662510e-02j]]), array([[ -9.97809318e-01 +6.61556073e-02j,
          1.29033277e-06 -3.47515179e-07j],
       [ -1.29033277e-06 -3.47515179e-07j,
         -9.97809318e-01 -6.61556073e-02j]]), array([[-0.99756454+0.06967098j,  0.00330216+0.00019381j],
       [-0.00330216+0.00019381j, -0.99756454-0.06967098j]]), array([[-0.99770280 +6.74425501e-02j,  0.00637362 +2.24655896e-05j],
       [-0.00637362 +2.24655896e-05j, -0.99770280 -6.74425501e-02j]]), array([[ -9.97188899e-01 +7.49278807e-02j,
         -3.28326378e-04 +7.14266866e-05j],
       [  3.28326378e-04 +7.14266866e-05j,
         -9.97188899e-01 -7.49278807e-02j]]), array([[-0.99677718+0.08004516j, -0.00510023-0.00141743j],
       [ 0.00510023-0.00141743j, -0.99677718-0.08004516j]]), array([[-0.99565604+0.09216059j, -0.01323210+0.00062667j],
       [ 0.01323210+0.00062667j, -0.99565604-0.09216059j]]), array([[ -9.96953544e-01+0.07799599j,   4.63474578e-04+0.00020692j],
       [ -4.63474578e-04+0.00020692j,  -9.96953544e-01-0.07799599j]]), array([[-0.99665965+0.08151296j, -0.00481877+0.00140296j],
       [ 0.00481877+0.00140296j, -0.99665965-0.08151296j]]), array([[-0.99698928+0.07753119j, -0.00106074-0.00039597j],
       [ 0.00106074-0.00039597j, -0.99698928-0.07753119j]]), array([[-0.99678323+0.08004192j,  0.00405631-0.00015777j],
       [-0.00405631-0.00015777j, -0.99678323-0.08004192j]]), array([[-0.99631716+0.08564525j, -0.00410536+0.00039232j],
       [ 0.00410536+0.00039232j, -0.99631716-0.08564525j]]), array([[-0.99623348 +8.66938387e-02j, -0.00173990 +6.27706524e-05j],
       [ 0.00173990 +6.27706524e-05j, -0.99623348 -8.66938387e-02j]]), array([[-0.99632610+0.08556779j, -0.00350615+0.00041173j],
       [ 0.00350615+0.00041173j, -0.99632610-0.08556779j]]), array([[-0.99560944+0.09356508j,  0.00249987-0.00108382j],
       [-0.00249987-0.00108382j, -0.99560944-0.09356508j]]), array([[-0.99595362+0.08961811j, -0.00623046-0.00248223j],
       [ 0.00623046-0.00248223j, -0.99595362-0.08961811j]]), array([[ -9.95096494e-01+0.0988903j ,   9.04833540e-04-0.00169034j],
       [ -9.04833540e-04-0.00169034j,  -9.95096494e-01-0.0988903j ]]), array([[ -9.95219982e-01 +9.76584958e-02j,
         -5.27781641e-05 -6.01313482e-05j],
       [  5.27781641e-05 -6.01313482e-05j,
         -9.95219982e-01 -9.76584958e-02j]]), array([[-0.99446689+0.10494832j, -0.00459969-0.00054202j],
       [ 0.00459969-0.00054202j, -0.99446689-0.10494832j]]), array([[ -9.94675697e-01+0.10304199j,   2.11405320e-04+0.00160027j],
       [ -2.11405320e-04+0.00160027j,  -9.94675697e-01-0.10304199j]]), array([[-0.99480294+0.10162916j, -0.00619250-0.00052194j],
       [ 0.00619250-0.00052194j, -0.99480294-0.10162916j]]), array([[-0.9941425+0.10768804j, -0.0091623+0.00019055j],
       [ 0.0091623+0.00019055j, -0.9941425-0.10768804j]]), array([[ -9.93272525e-01+0.11579464j,  -7.56629429e-04-0.00084869j],
       [  7.56629429e-04-0.00084869j,  -9.93272525e-01-0.11579464j]]), array([[-0.99347324+0.11396703j,  0.00473194+0.00023162j],
       [-0.00473194+0.00023162j, -0.99347324-0.11396703j]]), array([[-0.99222784+0.12411858j,  0.00884121-0.00056813j],
       [-0.00884121-0.00056813j, -0.99222784-0.12411858j]]), array([[-0.99259719+0.12118104j,  0.00784279-0.00211355j],
       [-0.00784279-0.00211355j, -0.99259719-0.12118104j]]), array([[ -9.92282067e-01+0.12398696j,   4.12044084e-04-0.00183414j],
       [ -4.12044084e-04-0.00183414j,  -9.92282067e-01-0.12398696j]]), array([[ -9.91755713e-01 +1.28142909e-01j,
         -3.19212625e-06 -1.23350820e-06j],
       [  3.19212625e-06 -1.23350820e-06j,
         -9.91755713e-01 -1.28142909e-01j]]), array([[ -9.91160573e-01+0.13265124j,  -5.72541961e-04+0.00200997j],
       [  5.72541961e-04+0.00200997j,  -9.91160573e-01-0.13265124j]]), array([[-0.98883231+0.14878352j,  0.00830958-0.00225467j],
       [-0.00830958-0.00225467j, -0.98883231-0.14878352j]]), array([[-0.98547629+0.16877573j,  0.01299493-0.01350449j],
       [-0.01299493-0.01350449j, -0.98547629-0.16877573j]]), array([[-0.98621890+0.16538887j, -0.00429943+0.00055805j],
       [ 0.00429943+0.00055805j, -0.98621890-0.16538887j]]), array([[-0.98897509+0.14805547j,  0.00178465+0.00216096j],
       [-0.00178465+0.00216096j, -0.98897509-0.14805547j]]), array([[-0.98359689+0.18010772j, -0.00954081-0.00271086j],
       [ 0.00954081-0.00271086j, -0.98359689-0.18010772j]]), array([[-0.98681831+0.16180883j, -0.00099218+0.00255776j],
       [ 0.00099218+0.00255776j, -0.98681831-0.16180883j]]), array([[-0.98848477+0.1502161j , -0.00123422+0.01820615j],
       [ 0.00123422+0.01820615j, -0.98848477-0.1502161j ]]), array([[ -9.85143538e-01+0.17170865j,  -7.21640525e-04+0.00279816j],
       [  7.21640525e-04+0.00279816j,  -9.85143538e-01-0.17170865j]]), array([[-0.98447025+0.17509968j,  0.01258189+0.000362j  ],
       [-0.01258189+0.000362j  , -0.98447025-0.17509968j]]), array([[-0.97791171+0.20584774j,  0.03615250+0.0028954j ],
       [-0.03615250+0.0028954j , -0.97791171-0.20584774j]]), array([[-0.98178443 +1.89782597e-01j, -0.00904836 +1.38855725e-04j],
       [ 0.00904836 +1.38855725e-04j, -0.98178443 -1.89782597e-01j]]), array([[-0.98496627+0.17237885j,  0.01041778-0.00429425j],
       [-0.01041778-0.00429425j, -0.98496627-0.17237885j]]), array([[-0.98048583+0.19656497j, -0.00309561-0.00039842j],
       [ 0.00309561-0.00039842j, -0.98048583-0.19656497j]]), array([[ -9.77187949e-01 +2.12375665e-01j,
          5.27010800e-04 -1.05698567e-04j],
       [ -5.27010800e-04 -1.05698567e-04j,
         -9.77187949e-01 -2.12375665e-01j]]), array([[ -9.75550365e-01 +2.19775844e-01j,
         -2.39786292e-04 -8.41608773e-05j],
       [  2.39786292e-04 -8.41608773e-05j,
         -9.75550365e-01 -2.19775844e-01j]]), array([[-0.97583979+0.21839292j, -0.00639377+0.00060102j],
       [ 0.00639377+0.00060102j, -0.97583979-0.21839292j]]), array([[-0.97342586+0.22805694j, -0.02061853-0.00264461j],
       [ 0.02061853-0.00264461j, -0.97342586-0.22805694j]]), array([[-0.97091540+0.23802465j,  0.02130977-0.01460993j],
       [-0.02130977-0.01460993j, -0.97091540-0.23802465j]]), array([[ -9.66116341e-01 +2.58106984e-01j,
         -1.09233369e-16 +3.42065785e-16j],
       [  1.73797608e-16 +3.52907807e-16j,
         -9.66116341e-01 -2.58106984e-01j]]), array([[-0.96307626+0.26920778j, -0.00211471-0.00261049j],
       [ 0.00211471-0.00261049j, -0.96307626-0.26920778j]]), array([[-0.95990194+0.28028121j, -0.00152474+0.00532719j],
       [ 0.00152474+0.00532719j, -0.95990194-0.28028121j]]), array([[-0.95978261+0.27994279j,  0.02119315+0.0004831j ],
       [-0.02119315+0.0004831j , -0.95978261-0.27994279j]]), array([[-0.95369124+0.29928881j, -0.02641530-0.01419372j],
       [ 0.02641530-0.01419372j, -0.95369124-0.29928881j]]), array([[-0.95300050+0.29855463j,  0.01350264-0.04972791j],
       [-0.01350264-0.04972791j, -0.95300050-0.29855463j]]), array([[-0.94280658+0.33220921j, -0.02734034-0.0023018j ],
       [ 0.02734034-0.0023018j , -0.94280658-0.33220921j]]), array([[-0.94608861+0.3234423j, -0.01727509+0.001729j ],
       [ 0.01727509+0.001729j , -0.94608861-0.3234423j]]), array([[ -9.31819806e-01 +3.62920518e-01j,
          7.35800220e-04 +7.61827155e-05j],
       [ -7.35800220e-04 +7.61827155e-05j,
         -9.31819806e-01 -3.62920518e-01j]]), array([[-0.92781895+0.37301008j, -0.00293598-0.00261779j],
       [ 0.00293598-0.00261779j, -0.92781895-0.37301008j]]), array([[-0.91820824+0.39600842j, -0.00320482+0.00779091j],
       [ 0.00320482+0.00779091j, -0.91820824-0.39600842j]]), array([[-0.90976837+0.41349469j, -0.03635573-0.00468155j],
       [ 0.03635573-0.00468155j, -0.90976837-0.41349469j]]), array([[ -9.01690535e-01 +4.32381983e-01j,
          3.00818617e-06 +5.87080867e-06j],
       [ -3.00818617e-06 +5.87080867e-06j,
         -9.01690535e-01 -4.32381983e-01j]]), array([[-0.89162288+0.44411046j,  0.08199711+0.0324193j ],
       [-0.08199711+0.0324193j , -0.89162288-0.44411046j]]), array([[-0.88508009+0.46505364j, -0.01851786-0.00392923j],
       [ 0.01851786-0.00392923j, -0.88508009-0.46505364j]]), array([[-0.86041347+0.50782581j,  0.04213284+0.00514122j],
       [-0.04213284+0.00514122j, -0.86041347-0.50782581j]]), array([[-0.85645944+0.51369157j, -0.05074648+0.00479501j],
       [ 0.05074648+0.00479501j, -0.85645944-0.51369157j]]), array([[ -8.43760792e-01 +5.36719409e-01j,
          3.60709759e-05 +7.21470780e-06j],
       [ -3.60709759e-05 +7.21470780e-06j,
         -8.43760792e-01 -5.36719409e-01j]]), array([[-0.83001193+0.55590518j, -0.03553912+0.02804638j],
       [ 0.03553912+0.02804638j, -0.83001193-0.55590518j]]), array([[-0.80789881+0.58925195j, -0.00143130+0.00892183j],
       [ 0.00143130+0.00892183j, -0.80789881-0.58925195j]]), array([[-0.80493470+0.59278216j, -0.00592716-0.02557944j],
       [ 0.00592716-0.02557944j, -0.80493470-0.59278216j]]), array([[-0.76719027+0.64085706j, -0.02626984-0.0055867j ],
       [ 0.02626984-0.0055867j , -0.76719027-0.64085706j]]), array([[-0.77527989+0.62487639j, -0.09185062-0.00583565j],
       [ 0.09185062-0.00583565j, -0.77527989-0.62487639j]]), array([[-0.73370505+0.67533678j, -0.07433339-0.00846684j],
       [ 0.07433339-0.00846684j, -0.73370505-0.67533678j]]), array([[-0.72018168+0.69376865j,  0.00096928-0.00473948j],
       [-0.00096928-0.00473948j, -0.72018168-0.69376865j]]), array([[-0.69943354+0.71469362j, -0.00187636+0.00149416j],
       [ 0.00187636+0.00149416j, -0.69943354-0.71469362j]]), array([[-0.66778235+0.73673113j, -0.10596016-0.00814907j],
       [ 0.10596016-0.00814907j, -0.66778235-0.73673113j]]), array([[-0.64134631+0.75992702j, -0.10548374-0.00768209j],
       [ 0.10548374-0.00768209j, -0.64134631-0.75992702j]]), array([[-0.63834617+0.76814899j, -0.04246767-0.02564745j],
       [ 0.04246767-0.02564745j, -0.63834617-0.76814899j]]), array([[-0.57184505 +8.20357252e-01j,  0.00268661 -2.15485904e-05j],
       [-0.00268661 -2.15485904e-05j, -0.57184505 -8.20357252e-01j]]), array([[-0.52946227+0.84432534j, -0.07366839+0.03684281j],
       [ 0.07366839+0.03684281j, -0.52946227-0.84432534j]]), array([[-0.50560057+0.86090779j, -0.05538120+0.0117798j ],
       [ 0.05538120+0.0117798j , -0.50560057-0.86090779j]]), array([[-0.47322435 +8.80941147e-01j, -0.00117698 -1.62684760e-04j],
       [ 0.00117698 -1.62684760e-04j, -0.47322435 -8.80941147e-01j]]), array([[ -4.40487372e-01+0.89775518j,  -3.54175706e-04-0.00252793j],
       [  3.54175706e-04-0.00252793j,  -4.40487372e-01-0.89775518j]]), array([[-0.40006249 +9.16486753e-01j,  0.00126570 +6.59100278e-04j],
       [-0.00126570 +6.59100278e-04j, -0.40006249 -9.16486753e-01j]]), array([[-0.35979866+0.93302849j, -0.00131741-0.00100896j],
       [ 0.00131741-0.00100896j, -0.35979866-0.93302849j]]), array([[-0.33489841+0.94222855j,  0.00528312+0.00452706j],
       [-0.00528312+0.00452706j, -0.33489841-0.94222855j]]), array([[-0.29461011 +9.54278598e-01j, -0.05056043 -9.40839732e-04j],
       [ 0.05056043 -9.40839732e-04j, -0.29461011 -9.54278598e-01j]]), array([[-0.27847528+0.95878947j, -0.04432363-0.03478045j],
       [ 0.04432363-0.03478045j, -0.27847528-0.95878947j]]), array([[-0.20673600+0.97081189j, -0.12148709-0.00503818j],
       [ 0.12148709-0.00503818j, -0.20673600-0.97081189j]]), array([[-0.16443545+0.97944466j,  0.11613631+0.01270858j],
       [-0.11613631+0.01270858j, -0.16443545-0.97944466j]]), array([[-0.12503871+0.99057704j, -0.05570836+0.00436215j],
       [ 0.05570836+0.00436215j, -0.12503871-0.99057704j]]), array([[-0.08427979+0.98709894j,  0.12902026+0.04343226j],
       [-0.12902026+0.04343226j, -0.08427979-0.98709894j]]), array([[-0.04631973 +9.98926250e-01j,  0.00088553 +2.16385160e-04j],
       [-0.00088553 +2.16385160e-04j, -0.04631973 -9.98926250e-01j]]), array([[-0.00389251+0.99998855j,  0.00249299+0.00123721j],
       [-0.00249299+0.00123721j, -0.00389251-0.99998855j]]), array([[ 0.03567567+0.99572102j, -0.03963843-0.07546976j],
       [ 0.03963843-0.07546976j,  0.03567567-0.99572102j]]), array([[ 0.08556798+0.99631068j, -0.00337031-0.00563817j],
       [ 0.00337031-0.00563817j,  0.08556798-0.99631068j]]), array([[ 0.11187778 +9.83841214e-01j, -0.13978491 -8.49903909e-05j],
       [ 0.13978491 -8.49903909e-05j,  0.11187778 -9.83841214e-01j]]), array([[  1.60847771e-01+0.98697322j,   5.30408391e-05+0.00344314j],
       [ -5.30408391e-05+0.00344314j,   1.60847771e-01-0.98697322j]]), array([[ 0.21345765+0.97680541j,  0.01183440+0.01212289j],
       [-0.01183440+0.01212289j,  0.21345765-0.97680541j]]), array([[ 0.26580980+0.96325615j, -0.03842721-0.00246551j],
       [ 0.03842721-0.00246551j,  0.26580980-0.96325615j]]), array([[  2.69072289e-01 +9.63119965e-01j,
         -3.49784367e-05 +1.86190385e-04j],
       [  3.49784367e-05 +1.86190385e-04j,
          2.69072289e-01 -9.63119965e-01j]]), array([[ 0.29965401+0.94483905j, -0.12501560+0.04310163j],
       [ 0.12501560+0.04310163j,  0.29965401-0.94483905j]]), array([[ 0.35417153 +9.35179110e-01j,  0.00140081 +7.71050841e-04j],
       [-0.00140081 +7.71050841e-04j,  0.35417153 -9.35179110e-01j]]), array([[ 0.36677168+0.93029925j, -0.00349370-0.00310392j],
       [ 0.00349370-0.00310392j,  0.36677168-0.93029925j]]), array([[ 0.39824484+0.90972669j,  0.11555815+0.0210881j ],
       [-0.11555815+0.0210881j ,  0.39824484-0.90972669j]]), array([[ 0.43749340 +8.99220637e-01j, -0.00130395 -2.64774345e-04j],
       [ 0.00130395 -2.64774345e-04j,  0.43749340 -8.99220637e-01j]]), array([[ 0.47795639+0.87038097j, -0.11587373+0.02383151j],
       [ 0.11587373+0.02383151j,  0.47795639-0.87038097j]]), array([[ 0.50806595+0.86131106j,  0.00293304-0.00191007j],
       [-0.00293304-0.00191007j,  0.50806595-0.86131106j]]), array([[ 0.53185988+0.84683093j,  0.00114777+0.00106154j],
       [-0.00114777+0.00106154j,  0.53185988-0.84683093j]]), array([[ 0.57620481+0.81724906j,  0.00594293+0.00752848j],
       [-0.00594293+0.00752848j,  0.57620481-0.81724906j]]), array([[ 0.59191498+0.80502228j, -0.03070795+0.02515578j],
       [ 0.03070795+0.02515578j,  0.59191498-0.80502228j]]), array([[ 0.61121129+0.78437377j, -0.10418614-0.01799423j],
       [ 0.10418614-0.01799423j,  0.61121129-0.78437377j]]), array([[  6.42483450e-01 +7.66299561e-01j,
          2.10335221e-16 +6.37510877e-17j],
       [  1.89518540e-16 +2.52619106e-16j,
          6.42483450e-01 -7.66299561e-01j]]), array([[ 0.68174374+0.729639j , -0.04834828-0.0226903j],
       [ 0.04834828-0.0226903j,  0.68174374-0.729639j ]]), array([[ 0.68952552+0.72027609j,  0.06177066-0.04406016j],
       [-0.06177066-0.04406016j,  0.68952552-0.72027609j]]), array([[ 0.71559561+0.69131741j,  0.09906618+0.01374937j],
       [-0.09906618+0.01374937j,  0.71559561-0.69131741j]]), array([[ 0.73772045+0.67047999j,  0.07715154+0.0165154j ],
       [-0.07715154+0.0165154j ,  0.73772045-0.67047999j]]), array([[  7.58765663e-01+0.65135502j,  -6.72471190e-04+0.00329508j],
       [  6.72471190e-04+0.00329508j,   7.58765663e-01-0.65135502j]]), array([[  7.76666634e-01+0.62990927j,   3.43200299e-04-0.00176975j],
       [ -3.43200299e-04-0.00176975j,   7.76666634e-01-0.62990927j]]), array([[  7.99021666e-01+0.60128452j,  -7.69409273e-04+0.00455076j],
       [  7.69409273e-04+0.00455076j,   7.99021666e-01-0.60128452j]]), array([[ 0.81790738+0.56947858j, -0.06575652-0.0489668j ],
       [ 0.06575652-0.0489668j ,  0.81790738-0.56947858j]]), array([[ 0.83314333+0.54752842j, -0.07218527+0.02956537j],
       [ 0.07218527+0.02956537j,  0.83314333-0.54752842j]]), array([[ 0.84752088+0.52718129j, -0.05771027+0.02139561j],
       [ 0.05771027+0.02139561j,  0.84752088-0.52718129j]]), array([[  8.62383846e-01+0.50625455j,  -2.55769280e-04+0.00060545j],
       [  2.55769280e-04+0.00060545j,   8.62383846e-01-0.50625455j]]), array([[ 0.87796342+0.47816966j, -0.02288213+0.00322673j],
       [ 0.02288213+0.00322673j,  0.87796342-0.47816966j]]), array([[  8.91042812e-01+0.45391782j,   2.42332526e-04-0.00112393j],
       [ -2.42332526e-04-0.00112393j,   8.91042812e-01-0.45391782j]]), array([[  9.04619314e-01 +4.26219879e-01j,
         -5.84692820e-04 -4.12315379e-04j],
       [  5.84692820e-04 -4.12315379e-04j,
          9.04619314e-01 -4.26219879e-01j]]), array([[ 0.91795420+0.39619348j,  0.00645204-0.0186865j ],
       [-0.00645204-0.0186865j ,  0.91795420-0.39619348j]]), array([[ 0.92758332+0.37360693j, -0.00244154+0.00104141j],
       [ 0.00244154+0.00104141j,  0.92758332-0.37360693j]]), array([[ 0.93606649+0.35156462j, -0.01166783-0.00676107j],
       [ 0.01166783-0.00676107j,  0.93606649-0.35156462j]]), array([[  9.46262657e-01+0.32339835j,  -4.87591595e-04+0.00050275j],
       [  4.87591595e-04+0.00050275j,   9.46262657e-01-0.32339835j]]), array([[ 0.95688556+0.28891576j,  0.02938136-0.00586864j],
       [-0.02938136-0.00586864j,  0.95688556-0.28891576j]]), array([[ 0.96251621+0.27087186j, -0.01375749+0.00131142j],
       [ 0.01375749+0.00131142j,  0.96251621-0.27087186j]]), array([[ 0.97130984+0.23781215j, -0.00157361-0.00032231j],
       [ 0.00157361-0.00032231j,  0.97130984-0.23781215j]]), array([[ 0.97527918+0.2209686j ,  0.00182846-0.00024364j],
       [-0.00182846-0.00024364j,  0.97527918-0.2209686j ]]), array([[ 0.98166950+0.18743027j, -0.02747093-0.02098188j],
       [ 0.02747093-0.02098188j,  0.98166950-0.18743027j]]), array([[ 0.98579765+0.16623697j, -0.02373522-0.00221202j],
       [ 0.02373522-0.00221202j,  0.98579765-0.16623697j]]), array([[ 0.99083905+0.13444759j, -0.01127337-0.00589356j],
       [ 0.01127337-0.00589356j,  0.99083905-0.13444759j]]), array([[ 0.99412052+0.10813268j, -0.00552704+0.00108129j],
       [ 0.00552704+0.00108129j,  0.99412052-0.10813268j]]), array([[ 0.99675713+0.07959128j, -0.01168078-0.00200199j],
       [ 0.01168078-0.00200199j,  0.99675713-0.07959128j]]), array([[  9.98641153e-01+0.05211162j,  -3.70967909e-04-0.0002988j ],
       [  3.70967909e-04-0.0002988j ,   9.98641153e-01-0.05211162j]]), array([[ 0.99964662+0.02628928j, -0.00357442-0.0016528j ],
       [ 0.00357442-0.0016528j ,  0.99964662-0.02628928j]]), array([[  9.99997018e-01-0.00141578j,  -3.27330782e-04+0.00196294j],
       [  3.27330782e-04+0.00196294j,   9.99997018e-01+0.00141578j]])], 'kpt': [[0.0, 0.0, 0], [0.0016447368421052631, 0.0, 0], [0.0032894736842105261, 0.0, 0], [0.0049342105263157892, 0.0, 0], [0.0065789473684210523, 0.0, 0], [0.0082236842105263153, 0.0, 0], [0.0098684210526315784, 0.0, 0], [0.011513157894736841, 0.0, 0], [0.013157894736842105, 0.0, 0], [0.014802631578947368, 0.0, 0], [0.016447368421052631, 0.0, 0], [0.018092105263157895, 0.0, 0], [0.019736842105263157, 0.0, 0], [0.021381578947368418, 0.0, 0], [0.023026315789473683, 0.0, 0], [0.024671052631578948, 0.0, 0], [0.026315789473684209, 0.0, 0], [0.02796052631578947, 0.0, 0], [0.029605263157894735, 0.0, 0], [0.03125, 0.0, 0], [0.032894736842105261, 0.0, 0], [0.034539473684210523, 0.0, 0], [0.036184210526315791, 0.0, 0], [0.037828947368421052, 0.0, 0], [0.039473684210526314, 0.0, 0], [0.041118421052631575, 0.0, 0], [0.042763157894736836, 0.0, 0], [0.044407894736842105, 0.0, 0], [0.046052631578947366, 0.0, 0], [0.047697368421052627, 0.0, 0], [0.049342105263157895, 0.0, 0], [0.050986842105263157, 0.0, 0], [0.052631578947368418, 0.0, 0], [0.054276315789473679, 0.0, 0], [0.055921052631578941, 0.0, 0], [0.057565789473684209, 0.0, 0], [0.05921052631578947, 0.0, 0], [0.060855263157894732, 0.0, 0], [0.0625, 0.0, 0], [0.064144736842105254, 0.0, 0], [0.065789473684210523, 0.0, 0], [0.067434210526315791, 0.0, 0], [0.069078947368421045, 0.0, 0], [0.070723684210526314, 0.0, 0], [0.072368421052631582, 0.0, 0], [0.074013157894736836, 0.0, 0], [0.075657894736842105, 0.0, 0], [0.077302631578947373, 0.0, 0], [0.078947368421052627, 0.0, 0], [0.080592105263157882, 0.0, 0], [0.08223684210526315, 0.0, 0], [0.083881578947368418, 0.0, 0], [0.085526315789473673, 0.0, 0], [0.087171052631578941, 0.0, 0], [0.088815789473684209, 0.0, 0], [0.090460526315789463, 0.0, 0], [0.092105263157894732, 0.0, 0], [0.09375, 0.0, 0], [0.095394736842105254, 0.0, 0], [0.097039473684210523, 0.0, 0], [0.098684210526315791, 0.0, 0], [0.10032894736842105, 0.0, 0], [0.10197368421052631, 0.0, 0], [0.10361842105263158, 0.0, 0], [0.10526315789473684, 0.0, 0], [0.10690789473684209, 0.0, 0], [0.10855263157894736, 0.0, 0], [0.11019736842105263, 0.0, 0], [0.11184210526315788, 0.0, 0], [0.11348684210526315, 0.0, 0], [0.11513157894736842, 0.0, 0], [0.11677631578947367, 0.0, 0], [0.11842105263157894, 0.0, 0], [0.12006578947368421, 0.0, 0], [0.12171052631578946, 0.0, 0], [0.12335526315789473, 0.0, 0], [0.125, 0.0, 0], [0.12664473684210525, 0.0, 0], [0.12828947368421051, 0.0, 0], [0.12993421052631576, 0.0, 0], [0.13157894736842105, 0.0, 0], [0.13322368421052633, 0.0, 0], [0.13486842105263158, 0.0, 0], [0.13651315789473684, 0.0, 0], [0.13815789473684209, 0.0, 0], [0.13980263157894735, 0.0, 0], [0.14144736842105263, 0.0, 0], [0.14309210526315791, 0.0, 0], [0.14473684210526316, 0.0, 0], [0.14638157894736842, 0.0, 0], [0.14802631578947367, 0.0, 0], [0.14967105263157893, 0.0, 0], [0.15131578947368421, 0.0, 0], [0.15296052631578949, 0.0, 0], [0.15460526315789475, 0.0, 0], [0.15625, 0.0, 0], [0.15789473684210525, 0.0, 0], [0.15953947368421051, 0.0, 0], [0.16118421052631576, 0.0, 0], [0.16282894736842102, 0.0, 0], [0.1644736842105263, 0.0, 0], [0.16611842105263158, 0.0, 0], [0.16776315789473684, 0.0, 0], [0.16940789473684209, 0.0, 0], [0.17105263157894735, 0.0, 0], [0.1726973684210526, 0.0, 0], [0.17434210526315788, 0.0, 0], [0.17598684210526316, 0.0, 0], [0.17763157894736842, 0.0, 0], [0.17927631578947367, 0.0, 0], [0.18092105263157893, 0.0, 0], [0.18256578947368418, 0.0, 0], [0.18421052631578946, 0.0, 0], [0.18585526315789475, 0.0, 0], [0.1875, 0.0, 0], [0.18914473684210525, 0.0, 0], [0.19078947368421051, 0.0, 0], [0.19243421052631576, 0.0, 0], [0.19407894736842105, 0.0, 0], [0.19572368421052633, 0.0, 0], [0.19736842105263158, 0.0, 0], [0.19901315789473684, 0.0, 0], [0.20065789473684209, 0.0, 0], [0.20230263157894735, 0.0, 0], [0.20394736842105263, 0.0, 0], [0.20559210526315791, 0.0, 0], [0.20723684210526316, 0.0, 0], [0.20888157894736842, 0.0, 0], [0.21052631578947367, 0.0, 0], [0.21217105263157893, 0.0, 0], [0.21381578947368418, 0.0, 0], [0.21546052631578944, 0.0, 0], [0.21710526315789472, 0.0, 0], [0.21875, 0.0, 0], [0.22039473684210525, 0.0, 0], [0.22203947368421051, 0.0, 0], [0.22368421052631576, 0.0, 0], [0.22532894736842102, 0.0, 0], [0.2269736842105263, 0.0, 0], [0.22861842105263158, 0.0, 0], [0.23026315789473684, 0.0, 0], [0.23190789473684209, 0.0, 0], [0.23355263157894735, 0.0, 0], [0.2351973684210526, 0.0, 0], [0.23684210526315788, 0.0, 0], [0.23848684210526316, 0.0, 0], [0.24013157894736842, 0.0, 0], [0.24177631578947367, 0.0, 0], [0.24342105263157893, 0.0, 0], [0.24506578947368418, 0.0, 0], [0.24671052631578946, 0.0, 0], [0.24835526315789475, 0.0, 0], [0.25, 0.0, 0], [0.25164473684210525, 0.0, 0], [0.25328947368421051, 0.0, 0], [0.25493421052631576, 0.0, 0], [0.25657894736842102, 0.0, 0], [0.25822368421052627, 0.0, 0], [0.25986842105263153, 0.0, 0], [0.26151315789473684, 0.0, 0], [0.26315789473684209, 0.0, 0], [0.26480263157894735, 0.0, 0], [0.26644736842105265, 0.0, 0], [0.26809210526315791, 0.0, 0], [0.26973684210526316, 0.0, 0], [0.27138157894736842, 0.0, 0], [0.27302631578947367, 0.0, 0], [0.27467105263157893, 0.0, 0], [0.27631578947368418, 0.0, 0], [0.27796052631578944, 0.0, 0], [0.27960526315789469, 0.0, 0], [0.28125, 0.0, 0], [0.28289473684210525, 0.0, 0], [0.28453947368421051, 0.0, 0], [0.28618421052631582, 0.0, 0], [0.28782894736842107, 0.0, 0], [0.28947368421052633, 0.0, 0], [0.29111842105263158, 0.0, 0], [0.29276315789473684, 0.0, 0], [0.29440789473684209, 0.0, 0], [0.29605263157894735, 0.0, 0], [0.2976973684210526, 0.0, 0], [0.29934210526315785, 0.0, 0], [0.30098684210526316, 0.0, 0], [0.30263157894736842, 0.0, 0], [0.30427631578947367, 0.0, 0], [0.30592105263157898, 0.0, 0], [0.30756578947368424, 0.0, 0], [0.30921052631578949, 0.0, 0], [0.31085526315789475, 0.0, 0], [0.3125, 0.0, 0], [0.31414473684210525, 0.0, 0], [0.31578947368421051, 0.0, 0], [0.31743421052631576, 0.0, 0], [0.31907894736842102, 0.0, 0], [0.32072368421052627, 0.0, 0], [0.32236842105263153, 0.0, 0], [0.32401315789473678, 0.0, 0], [0.32565789473684204, 0.0, 0], [0.32730263157894735, 0.0, 0], [0.3289473684210526, 0.0, 0], [0.33059210526315785, 0.0, 0], [0.33223684210526316, 0.0, 0], [0.33388157894736842, 0.0, 0], [0.33552631578947367, 0.0, 0], [0.33717105263157893, 0.0, 0], [0.33881578947368418, 0.0, 0], [0.34046052631578944, 0.0, 0], [0.34210526315789469, 0.0, 0], [0.34374999999999994, 0.0, 0], [0.3453947368421052, 0.0, 0], [0.34703947368421051, 0.0, 0], [0.34868421052631576, 0.0, 0], [0.35032894736842102, 0.0, 0], [0.35197368421052633, 0.0, 0], [0.35361842105263158, 0.0, 0], [0.35526315789473684, 0.0, 0], [0.35690789473684209, 0.0, 0], [0.35855263157894735, 0.0, 0], [0.3601973684210526, 0.0, 0], [0.36184210526315785, 0.0, 0], [0.36348684210526311, 0.0, 0], [0.36513157894736836, 0.0, 0], [0.36677631578947367, 0.0, 0], [0.36842105263157893, 0.0, 0], [0.37006578947368418, 0.0, 0], [0.37171052631578949, 0.0, 0], [0.37335526315789475, 0.0, 0], [0.375, 0.0, 0], [0.37664473684210525, 0.0, 0], [0.37828947368421051, 0.0, 0], [0.37993421052631576, 0.0, 0], [0.38157894736842102, 0.0, 0], [0.38322368421052627, 0.0, 0], [0.38486842105263153, 0.0, 0], [0.38651315789473684, 0.0, 0], [0.38815789473684209, 0.0, 0], [0.38980263157894735, 0.0, 0], [0.39144736842105265, 0.0, 0], [0.39309210526315791, 0.0, 0], [0.39473684210526316, 0.0, 0], [0.39638157894736842, 0.0, 0], [0.39802631578947367, 0.0, 0], [0.39967105263157893, 0.0, 0], [0.40131578947368418, 0.0, 0], [0.40296052631578944, 0.0, 0], [0.40460526315789469, 0.0, 0], [0.40625, 0.0, 0], [0.40789473684210525, 0.0, 0], [0.40953947368421051, 0.0, 0], [0.41118421052631582, 0.0, 0], [0.41282894736842107, 0.0, 0], [0.41447368421052633, 0.0, 0], [0.41611842105263158, 0.0, 0], [0.41776315789473684, 0.0, 0], [0.41940789473684209, 0.0, 0], [0.42105263157894735, 0.0, 0], [0.4226973684210526, 0.0, 0], [0.42434210526315785, 0.0, 0], [0.42598684210526311, 0.0, 0], [0.42763157894736836, 0.0, 0], [0.42927631578947362, 0.0, 0], [0.43092105263157887, 0.0, 0], [0.43256578947368418, 0.0, 0], [0.43421052631578944, 0.0, 0], [0.43585526315789469, 0.0, 0], [0.4375, 0.0, 0], [0.43914473684210525, 0.0, 0], [0.44078947368421051, 0.0, 0], [0.44243421052631576, 0.0, 0], [0.44407894736842102, 0.0, 0], [0.44572368421052627, 0.0, 0], [0.44736842105263153, 0.0, 0], [0.44901315789473678, 0.0, 0], [0.45065789473684204, 0.0, 0], [0.45230263157894735, 0.0, 0], [0.4539473684210526, 0.0, 0], [0.45559210526315785, 0.0, 0], [0.45723684210526316, 0.0, 0], [0.45888157894736842, 0.0, 0], [0.46052631578947367, 0.0, 0], [0.46217105263157893, 0.0, 0], [0.46381578947368418, 0.0, 0], [0.46546052631578944, 0.0, 0], [0.46710526315789469, 0.0, 0], [0.46874999999999994, 0.0, 0], [0.4703947368421052, 0.0, 0], [0.47203947368421051, 0.0, 0], [0.47368421052631576, 0.0, 0], [0.47532894736842102, 0.0, 0], [0.47697368421052633, 0.0, 0], [0.47861842105263158, 0.0, 0], [0.48026315789473684, 0.0, 0], [0.48190789473684209, 0.0, 0], [0.48355263157894735, 0.0, 0], [0.4851973684210526, 0.0, 0], [0.48684210526315785, 0.0, 0], [0.48848684210526311, 0.0, 0], [0.49013157894736836, 0.0, 0], [0.49177631578947367, 0.0, 0], [0.49342105263157893, 0.0, 0], [0.49506578947368418, 0.0, 0], [0.49671052631578949, 0.0, 0], [0.49835526315789475, 0.0, 0], [0.5, 0.0, 0]], 'gap': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.99999999999999989, 0.0, 0.0, 0.99999999999999989, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.99999999999999989, 0.0, 0.99999999999999989, 0.0, 0.99999999999999989, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.99999999999999989, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.99999999999999989, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999978, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.99999999999999989, 0.0, 0.0, 0.99999999999999989, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.5, 0.5, 0.49999999999999994, 0.50000000000000011, 0.5, 0.5, 0.50000000000000022, 0.5, 0.5, 0.49999999999999989, 0.5, 0.5, 0.5, 0.49999999999999994, 0.5, 0.5, 0.5, 0.5, 0.49999999999999994, 0.5, 0.50000000000000011, 0.49999999999999994, 0.5, 0.49999999999999989, 0.49999999999999994, 0.5, 0.5, 0.5, 0.5, 0.5, 0.49999999999999994, 0.49999999999999994, 0.5, 0.49999999999999994, 0.5, 0.49999999999999989, 0.50000000000000011, 0.49999999999999994, 0.5, 0.5, 0.49999999999999994, 0.5, 0.49999999999999994, 0.49999999999999994, 0.5, 0.50000000000000011, 0.50000000000000011, 0.5, 0.49999999999999994]}

        self.assertFullAlmostEqual(tb_surface.get_res(), res)

    def test_warning(self):
        """ test the warning that is given when string_vec != None"""
        self.createH(0.1, 0.3)
        # call to Z2Pack
        tb_system = z2pack.tb.System(self.H)
        with warnings.catch_warnings(record=True) as w:
            warnings.simplefilter('always')
            tb_surface = tb_system.surface(lambda kx: [kx / 2, 0, 0], [0, 1, 0])
            assert len(w) == 1
            assert w[-1].category == DeprecationWarning
            assert "string_vec" in str(w[-1].message)

    def test_saveload(self):
        self.createH(0.1, 0.3)
        tb_system = z2pack.tb.System(self.H)
        surface1 = tb_system.surface(lambda kx, ky: [kx / 2, ky, 0], pickle_file=self._build_folder + '/tb_pickle.txt')
        surface2 = tb_system.surface(lambda kx, ky: [kx / 2, ky, 0], pickle_file=self._build_folder + '/tb_pickle.txt')
        surface1.wcc_calc(verbose=False)
        surface2.load()
        self.assertFullAlmostEqual(surface1.get_res(), surface2.get_res())

    def testkwargcheck1(self):
        """ test kwarg check on wcc_calc """
        self.createH(0.1, 0.3)
        # call to Z2Pack
        tb_system = z2pack.tb.System(self.H)
        tb_surface = tb_system.surface(lambda kx, ky: [kx / 2, ky, 0])
        self.assertRaises(
            TypeError,
            tb_surface.wcc_calc,
            invalid_kwarg = 3)

    def testkwargcheck2(self):
        """ test kwarg check on __init__ """
        self.createH(0, 0.3)
        # call to Z2Pack
        tb_system = z2pack.tb.System(self.H)
        self.assertRaises(
            TypeError,
            tb_system.surface,
            1, 2, 0, invalid_kwarg = 3)

if __name__ == "__main__":
    unittest.main()
